{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","node_modules/@atmos/config/enums.json","node_modules/@atmos/config/menu.json","node_modules/websocket-pull-stream/cmds.json","main.js","node_modules/riot/riot.js","logic/router.js","views/menu/view.tag","views/excitement-in/view.tag","views/excitement-out/view.tag","views/menu/view.js","views/excitement-out/view.js","views/excitement-in/view.js","logic/sync.js","logic/uid.js","node_modules/websocket-pull-stream/index.js","node_modules/websocket-pull-stream/lib/utils-browser.js","node_modules/websocket-pull-stream/node_modules/pull-plex/index.js","node_modules/websocket-pull-stream/node_modules/setimmediate-min/index.js","node_modules/websocket-pull-stream/node_modules/pull-core/index.js","node_modules/websocket-pull-stream/node_modules/pull-plex/lib/encdec-browser.js","node_modules/websocket-pull-stream/node_modules/pull-plex/lib/encdec-string.js","node_modules/websocket-pull-stream/node_modules/pull-plex/node_modules/varint/index.js","node_modules/websocket-pull-stream/node_modules/pull-plex/node_modules/varint/encode.js","node_modules/websocket-pull-stream/node_modules/pull-plex/node_modules/varint/length.js","node_modules/websocket-pull-stream/node_modules/pull-plex/node_modules/varint/decode.js"],"names":["tab","target","tabs","filter","t","forEach","classList","add","remove","require","mount","router","document","querySelector","results","mood","_results","_mood","window","loopKeys","expr","b0","brackets","els","slice","length","match","key","pos","val","mkitem","item","_each","dom","parent","remAttr","checksum","template","outerHTML","root","parentNode","placeholder","createComment","tags","child","getTag","insertBefore","one","stub","removeChild","on","test","items","tmpl","isArray","JSON","stringify","Object","keys","map","frag","createDocumentFragment","i","j","unmount","_item","Tag","isLoop","appendChild","update","getTagName","walk","node","nodeType","_looped","_visited","setNamed","parseNamedElements","childTags","getAttribute","cachedTag","tag","innerHTML","tagName","ptag","push","parseExpressions","expressions","addExpr","extra","indexOf","extend","type","nodeValue","attr","each","attributes","name","bool","split","value","impl","conf","updateOpts","el","opts","self","toggle","isMount","evt","loopDom","riot","observable","this","inherit","mkdom","fn","toLowerCase","TAG_ATTRIBUTES","_tag","isMounted","attrs","a","kv","setAttribute","replace","_id","fastAbs","Date","getTime","Math","random","replaceYield","data","trigger","mixin","arguments","mix","bind","init","call","firstChild","isInStub","keepRootTag","p","splice","undefined","off","setEventHandler","handler","e","event","which","charCode","keyCode","srcElement","currentTarget","ignored","preventDefault","returnValue","preventUpdate","insertTo","before","attrName","toString","inStub","createTextNode","style","display","len","isFunction","v","removeAttribute","nr","namedTag","src","obj","args","checkie","ieVersion","matches","exec","rootTag","mkEl","optgroupInnerHTML","optionInnerHTML","tbodyInnerHTML","nextSibling","createElement","$$","selector","ctx","querySelectorAll","Child","prototype","html","div","loops","opt","valRegx","selRegx","eachRegx","ifRegx","innerRegx","valuesMatch","selectedMatch","innerValue","eachMatch","ifMatch","labelRegx","elementRegx","tagRegx","labelMatch","elementMatch","tagMatch","innerContent","options","trim","innerOpt","tagImpl","RIOT_TAG","injectStyle","css","styleNode","head","styleSheet","cssText","_rendered","body","rs","mountTo","_innerHTML","virtualDom","version","settings","T_STRING","T_OBJECT","Array","_ts","win","documentMode","callbacks","events","typed","cb","arr","apply","fns","busy","concat","all","mixins","hash","loc","href","parser","path","emit","current","location","started","r","route","arg","stop","removeEventListener","detachEvent","start","addEventListener","attachEvent","orig","cachedBrackets","b","re","x","s","RegExp","source","global","extract","Function","join","n","pair","_","k","wrap","nonull","reVars","str","substrings","parts","sub","open","close","level","cache","addRiotTags","list","selectAllTags","pushTags","allTags","nodeList","_el","util","exports","module","define","amd","routes","_len","_key","menu","scope","sync","enums","EXCITED","NEUTRAL","BORED","parseInt","excited","vote","neutral","bored","pull","ws","WebSocket","srv","uid","c","charCodeAt","chan","Error","sink","Funnel","assign","demux","channel","pipe","Tunnel","send","Uint8Array","localStorage","substr","webSocketPullStream","socket","facade","defaults","duplex","multi","plex","flow","mode","View","command","makeCommandHandler","Source","end","next","msg","ran","bridge","Sink","read","readyState","setImmediate","waitReady","Through","cmdReciever","readRequester","encCmds","READ","wrapper","json","constructor","parse","coaxial","noop","objects","encase","stream","mux","offset","channels","__proto__","mutation","cmd","message","cmds","END","utils","cmdKeys","reduce","o","binaryType","topic","removeListener","String","remover","ix","index","abort","encdec","devnull","d","recieverChannel","cbs","aborted","through","coax","decoded","by","demuxxing","ed","setTimeout","addPipe","reader","id","prop","tester","createRead","unshift","piped","shift","createReader","maybeSink","maybeDrain","createSink","ended","err","string","varint","chunk","viSize","buffer","encodingLength","ArrayBuffer","byteLength","encode","set","decode","bytes","FILL","fromCharCode","maxVarintLength","num","out","oldOffset","INT","MSB","MSBALL","REST","pow","N1","N2","N3","N4","N5","N6","N7","buf","res","counter","l","bytesRead"],"mappings":"AAAA;YMAA,IAAM+G,MAAOtG,QAAQ,OAErByS,QAAOD,QAAU,cAACI,GAAMnK,SAAAV,UAAA,MAAKA,UAAA,EAE3BzB,MAAKuJ,MAAM,sCAAaN,EAAInB,MAAAyE,GAAAC,EAAA,EAAAD,EAAAC,EAAAA,IAAJvD,EAAIuD,GAAA/K,UAAA+K,EAC1BvD,GAAOA,EAAK7P,OAAO,SAAAgR,SAAKA,GAAE1P,SAC1BuO,EAAOA,EAAK,GAERqD,EAAOrD,YAAiBwB,WAC3B6B,EAAOrD;;AATZ,IAAM,IAAI,GAAG,COAb,IAAIoE,EPAgB,CAAC,GOAV3T,GPAgB,CAAC,CAAC,GOAV,yBACf4T,GAAK,GAAIC,WAAU,uBACnBC,IAAMH,KAAKC,MACXG,IAAM/T,QAAQ,WAAW0F,MAAM,IAAIxC,IAAI,SAAC8Q,SAAMA,GAAEC,WAAW,IAE/DxB,QAAOD,QAAU,SAACQ,EAAOkB,EAAMhR,GAC7B,GAAoB,gBAATgR,GACT,KAAMC,OAAM,sBAGd,IAAMC,GAAOT,KAAKU,OAAO,SAAU9J,GACjCvH,OAAOsR,OAAOtB,EAAOzI,GACrByI,EAAMpP,UAGR,OAAIV,aAAe6N,UACV+C,IACJS,MAAMC,QAAQN,GACdO,KAAKd,KAAKe,OAAOxR,MACjBuR,KAAKL,KAGHN,IACJS,MAAMC,QAAQN,GACdO,KAAKL,MAGV3B,OAAOD,QAAQgB,KAAO,SAACU,GACrB,GAAoB,gBAATA,GACT,KAAMC,OAAM,sBAGdP,IAAGe,KAAK,GAAIC,YAAWb,IAAI/E,OAAOkF,MAGpCzB,OAAOD,QAAQsB,IAAMA,IACrBrB,OAAOD,QAAQmB,KAAOA;;APlCtB,AOFA,IAAI,EPEE,CAAC,COFC,GAAG,CCAXlB,EREc,GAAG,COFC,CAAC,CCAZD,QAAU,CREiB,UQAhC,GDFwC,CAAC,CAAC,CCC1CqC,cAAad,IAAMc,aAAad,KAAOtM,KAAKC,SAASiC,SAAS,IAAImL,OAAO,EAAG,GACrED,aAAad;ADDtB,IAAI,EPCc,AODZ,GAAG,GPCe,CODX,SAAS,CAAC,qBPCI,AODiB,CAAC,CPChB,AODiB;AAC9C,ACFA,IDEI,ECFE,CDEC,ACFA,GDEG,ETmBV,ESnBc,ACFA,CDEC,EAAE,ACFA,CDEC,EAAE,CAAC,ATmBZxU,KAAIC,GUrBU,AVsBnBC,KACGC,OAAO,SAAAC,SAAKA,KAAMH,IAClBI,QAAQ,SAAAD,SAAKA,GAAEE,UAAUC,IAAI,YAEhCN,EAAOK,UAAUE,OAAO,UA1B5BC,QAAQ,gBAERA,QAAQ,yBACRA,QAAQ,0BAERA,QAAQ,QAAQC,MAAM,IAEtB,IAAMC,QAASF,QAAQ,kBACjBP,MACJU,SAASC,cAAc,WACvBD,SAASC,cAAc,SAGlBC,QAAiBZ,KAAI,GAAZa,KAAQb,KAAI,EAG5BS,SACEG,QAAO,SAAAE,yGAAA,WAAKhB,IAAIc,WAChBC,KAAI,SAAAE,yGAAC,WAAKjB,IAAIe;AEdd,AODF,ACFE,IDEE,EPCE,CAAC,AODA,GAAG,EPCE,CAAC,CQHC,CAAC,EDEE,CAAC,ACFA,GAAG,IRGW,AODP,CAAC,EAAE,CAAC,ICFI,CDEC,ACFA,CDEC,EAAE,ACFA,CDEC,CAAC,ECFE,CDEC,CAAC,ECFE,CAAC,MAAM,CDER,CAAC,ACFS,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC/E,AVFF,AHAA,OGAO,CAAC,CSG0C,ACDzC,CDC0C,CAAC,UAAU,ACDzC,CDC0C,ACDzC,AVFA,CSG0C,ATHzC,CSG0C,ATH1C,CUEE,CAAC,YREA,IAAI;AAAJ,CODuC,ACAhE,CDAiE,ACAjE,CDAkE,OPCrC;AFF9B,AFFA,OEEO,CAAC,uBAAuB,CAAC,CAAA;ASGhC,ATFA,MSEM,CAAC,ATFA,CAAC,MSEM,GAAG,UAAC,KAAK,ATFS,CAAC,CSER,ATFQ,ISEJ,EAAE,GAAG,EAAK;APAnC,AOCF,CRJD,KQIK,EPDE,EDHGG,CCGA,EOCE,ARHX,ECEa,CAAC,COCC,KPDK,AOCA,CPDC,ED8ZvB,KQ7Z8B,EAAE,CPDT,CAAC,AD8ZfC,GAASC,GAChB,GAAIC,GAAKC,EAAS,GACdC,EAAMH,EAAKI,MAAMH,EAAGI,QAAQC,MAAM,yCACtC,OAAOH,IAAQI,IAAKJ,EAAI,GAAIK,IAAKL,EAAI,GAAIM,IAAKR,EAAKE,EAAI,KAASM,IAAKT,GAGvE,QAASU,GAAOV,EAAMO,EAAKE,GACzB,GAAIE,KAGJ,OAFAA,GAAKX,EAAKO,KAAOA,EACbP,EAAKQ,MAAKG,EAAKX,EAAKQ,KAAOC,GACxBE,EAKT,QAASC,GAAMC,EAAKC,EAAQd,GAE1Be,EAAQF,EAAK,OAEb,IAKIG,GALAC,EAAWJ,EAAIK,UACfC,EAAON,EAAIO,WACXC,EAAc7B,SAAS8B,cAAc,oBACrCC,KACAC,EAAQC,EAAOZ,EAGnBM,GAAKO,aAAaL,EAAaR,GAE/Bb,EAAOD,EAASC,GAGhBc,EACGa,IAAI,WAAY,WACXR,EAAKS,OAAMT,EAAOL,EAAOK,MAE7BN,EAAIO,WAAWS,YAAYhB,KAE5BiB,GAAG,SAAU,WACZ,GACIC,GADAC,EAAQC,EAAKjC,EAAKS,IAAKK,EAI3B,KAAKoB,EAAQF,GAAQ,CAGnB,GAFAD,EAAOf,EACPA,EAAWgB,EAAQG,KAAKC,UAAUJ,GAAS,GACvChB,IAAae,EAAM,MAEvBC,GAASA,EACPK,OAAOC,KAAKN,GAAOO,IAAI,SAAUhC,GAC/B,MAAOG,GAAOV,EAAMO,EAAKyB,EAAMzB,SASrC,IALA,GAAIiC,GAAOhD,SAASiD,yBAChBC,EAAInB,EAAKlB,OACTsC,EAAIX,EAAM3B,OAGPqC,EAAIC,GAAGpB,IAAOmB,GAAGE,SAIxB,KAHArB,EAAKlB,OAASsC,EAEdZ,GAAQf,KAAchB,EAAKO,IACtBmC,EAAI,EAAOC,EAAJD,IAASA,EAAG,CACtB,GAAIG,GAAQd,EAAOrB,EAAOV,EAAMgC,EAAMU,GAAIA,GAAKV,EAAMU,EAEhDnB,GAAKmB,MAEPnB,EAAKmB,GAAK,GAAII,IAAMb,KAAMhB,IACvBH,OAAQA,EACRiC,QAAQ,EACR5B,KAAMA,EACNR,KAAMkC,KAERvD,QAEFkD,EAAKQ,YAAYzB,EAAKmB,GAAGvB,OAE3BI,EAAKmB,GAAGG,MAAQA,EAChBtB,EAAKmB,GAAGO,OAAOJ,GAGjB1B,EAAKO,aAAac,EAAMnB,GAEpBG,IAAOV,EAAOS,KAAK2B,EAAWrC,IAAQU,KAEzCI,IAAI,UAAW,WAChB,GAAIW,GAAOD,OAAOC,KAAKxB,EACvBqC,GAAKhC,EAAM,SAASiC,GAEG,GAAjBA,EAAKC,UAAkBD,EAAKL,QAAWK,EAAKE,UAC9CF,EAAKG,UAAW,EAChBH,EAAKE,SAAU,EACfE,EAASJ,EAAMtC,EAAQwB,QAQjC,QAASmB,GAAmBtC,EAAML,EAAQ4C,GAExCP,EAAKhC,EAAM,SAASN,GAClB,GAAoB,GAAhBA,EAAIwC,SAAe,CACrBxC,EAAIkC,OAAUlC,EAAIO,YAAcP,EAAIO,WAAW2B,QAAUlC,EAAI8C,aAAa,QAAW,EAAI,CAGzF,IAAInC,GAAQC,EAAOZ,EAEnB,IAAIW,IAAUX,EAAIkC,OAAQ,CAMxB,IALA,GAGIa,GAHAC,EAAM,GAAIf,GAAItB,GAASL,KAAMN,EAAKC,OAAQA,GAAUD,EAAIiD,WACxDC,EAAUb,EAAWrC,GACrBmD,EAAOlD,GAGHW,EAAOuC,EAAK7C,OACb6C,EAAKlD,QACVkD,EAAOA,EAAKlD,MAId+C,GAAI/C,OAASkD,EAEbJ,EAAYI,EAAKzC,KAAKwC,GAGlBH,GAGG1B,EAAQ0B,KACXI,EAAKzC,KAAKwC,IAAYH,IAExBI,EAAKzC,KAAKwC,GAASE,KAAKJ,IAExBG,EAAKzC,KAAKwC,GAAWF,EAKvBhD,EAAIiD,UAAY,GAChBJ,EAAUO,KAAKJ,GAGZhD,EAAIkC,QACPS,EAAS3C,EAAKC,SAOtB,QAASoD,GAAiB/C,EAAM0C,EAAKM,GAEnC,QAASC,GAAQvD,EAAKJ,EAAK4D,GACzB,GAAI5D,EAAI6D,QAAQpE,EAAS,KAAO,EAAG,CACjC,GAAIF,IAASa,IAAKA,EAAKb,KAAMS,EAC7B0D,GAAYF,KAAKM,EAAOvE,EAAMqE,KAIlClB,EAAKhC,EAAM,SAASN,GAClB,GAAI2D,GAAO3D,EAAIwC,QAIf,IADY,GAARmB,GAAuC,SAA1B3D,EAAIO,WAAW2C,SAAoBK,EAAQvD,EAAKA,EAAI4D,WACzD,GAARD,EAAJ,CAKA,GAAIE,GAAO7D,EAAI8C,aAAa,OAE5B,OAAIe,IAAQ9D,EAAMC,EAAKgD,EAAKa,IAAc,IAG1CC,EAAK9D,EAAI+D,WAAY,SAASF,GAC5B,GAAIG,GAAOH,EAAKG,KACdC,EAAOD,EAAKE,MAAM,MAAM,EAG1B,OADAX,GAAQvD,EAAK6D,EAAKM,OAASN,KAAMI,GAAQD,EAAMC,KAAMA,IACjDA,GAAQ/D,EAAQF,EAAKgE,IAAc,GAAvC,SAKEpD,EAAOZ,IAAa,EAAxB,WAKJ,QAASiC,GAAImC,EAAMC,EAAMpB,GAyDvB,QAASqB,KAEPR,EAAKxD,EAAKyD,WAAY,SAASQ,GAC7BC,EAAKD,EAAGP,MAAQ5C,EAAKmD,EAAGJ,MAAOlE,GAAUwE,KAG3CX,EAAKtC,OAAOC,KAAKoC,GAAO,SAASG,GAC/BQ,EAAKR,GAAQ5C,EAAKyC,EAAKG,GAAO/D,GAAUwE,KAuG5C,QAASC,GAAOC,GAMd,GAHAb,EAAKjB,EAAW,SAASlC,GAASA,EAAMgE,EAAU,QAAU,eAGxD1E,EAAQ,CACV,GAAI2E,GAAMD,EAAU,KAAO,KAGvBzC,GACFjC,EAAO2E,GAAK,UAAWH,EAAK1C,SAE5B9B,EAAO2E,GAAK,SAAUH,EAAKrC,QAAQwC,GAAK,UAAWH,EAAK1C,UAlL9D,GAYI8C,GAZAJ,EAAOK,EAAKC,WAAWC,MACvBR,EAAOS,EAAQZ,EAAKG,UACpBxE,EAAMkF,EAAMd,EAAKhD,MACjBnB,EAASoE,EAAKpE,OACdiC,EAASmC,EAAKnC,OACdpC,EAAOuE,EAAKvE,KACZwD,KACAT,KACAvC,EAAO+D,EAAK/D,KACZ6E,EAAKf,EAAKe,GACVjC,EAAU5C,EAAK4C,QAAQkC,cACvBvB,KAEAwB,EAAiB,qCAUrB,IAPIF,GAAM7E,EAAKgF,MACbhF,EAAKgF,KAAKvD,SAAQ,GAIpBiD,KAAKO,WAAY,EAEbnB,EAAKoB,MAAO,CACd,GAAIA,GAAQpB,EAAKoB,MAAM/F,MAAM4F,EAE7BvB,GAAK0B,EAAO,SAASC,GACnB,GAAIC,GAAKD,EAAEvB,MAAM,UACjB5D,GAAKqF,aAAaD,EAAG,GAAIA,EAAG,GAAGE,QAAQ,QAAS,OAOpDtF,EAAKgF,KAAON,KAIZA,KAAKa,IAAMC,MAAW,GAAIC,OAAOC,UAAYC,KAAKC,WAElDxC,EAAOsB,MAAQ/E,OAAQA,EAAQK,KAAMA,EAAMkE,KAAMA,EAAM9D,SAAYZ,GAGnEgE,EAAKxD,EAAKyD,WAAY,SAASQ,GAC7B,GAAI3E,GAAM2E,EAAGJ,KAET9E,GAAS,UAAU6B,KAAKtB,KAAMiE,EAAKU,EAAGP,MAAQpE,KAGhDI,EAAIiD,YAAc,kCAAkC/B,KAAKgC,KAE3DlD,EAAIiD,UAAYkD,EAAanG,EAAIiD,UAAWA,IAc9C+B,KAAK5C,OAAS,SAASgE,GACrB1C,EAAOe,EAAM2B,GACb9B,IACAG,EAAK4B,QAAQ,SAAUD,GACvBhE,EAAOkB,EAAamB,EAAM2B,GAC1B3B,EAAK4B,QAAQ,YAGfrB,KAAKsB,MAAQ,WACXxC,EAAKyC,UAAW,SAASC,GACvBA,EAAoB,gBAAPA,GAAkB1B,EAAKwB,MAAME,GAAOA,EACjD1C,EAAKtC,OAAOC,KAAK+E,GAAM,SAAS9G,GAEnB,QAAPA,IACF+E,EAAK/E,GAA0B,kBAAZ8G,GAAI9G,GAAqB8G,EAAI9G,GAAK+G,KAAKhC,GAAQ+B,EAAI9G,MAGtE8G,EAAIE,MAAMF,EAAIE,KAAKD,KAAKhC,QAIhCO,KAAKvG,MAAQ,WAkBX,GAhBA6F,IAGAa,GAAMA,EAAGwB,KAAKlC,EAAMD,GAEpBE,GAAO,GAIPrB,EAAiBrD,EAAKyE,EAAMnB,GAEvBmB,EAAKxE,QAAQwE,EAAKrC,SAGvBqC,EAAK4B,QAAQ,YAETnE,EAEFuC,EAAKnE,KAAOA,EAAOuE,EAAU7E,EAAI4G,eAC5B,CACL,KAAO5G,EAAI4G,YAAYtG,EAAK6B,YAAYnC,EAAI4G,WACxCtG,GAAKS,OAAM0D,EAAKnE,KAAOA,EAAOL,EAAOK,OAGtCmE,EAAKxE,QAAUwE,EAAKxE,OAAOsF,WAC9Bd,EAAKc,WAAY,EACjBd,EAAK4B,QAAQ,UAGV5B,EAAKxE,OAAOa,IAAI,QAAS,WAGvB+F,EAASpC,EAAKnE,QACjBmE,EAAKxE,OAAOsF,UAAYd,EAAKc,WAAY,EACzCd,EAAK4B,QAAQ,aAMnBrB,KAAKjD,QAAU,SAAS+E,GACtB,GAAIvC,GAAKM,GAAWvE,EAChByG,EAAIxC,EAAGhE,UAEX,IAAIwG,EAAG,CAEL,GAAI9G,EAIEoB,EAAQpB,EAAOS,KAAKwC,IACtBY,EAAK7D,EAAOS,KAAKwC,GAAU,SAASF,EAAKnB,GACnCmB,EAAI6C,KAAOpB,EAAKoB,KAClB5F,EAAOS,KAAKwC,GAAS8D,OAAOnF,EAAG,KAInC5B,EAAOS,KAAKwC,GAAW+D,WAEzB,MAAO1C,EAAGqC,YAAYrC,EAAGvD,YAAYuD,EAAGqC,WAGrCE,IACHC,EAAE/F,YAAYuD,GAKlBE,EAAK4B,QAAQ,WACb3B,IACAD,EAAKyC,IAAI,KAET5G,EAAKgF,KAAO,MAsBd1C,EAAmB5C,EAAKgF,KAAMnC,GAKhC,QAASsE,GAAgBnD,EAAMoD,EAASpH,EAAKgD,EAAKlD,GAEhDE,EAAIgE,GAAQ,SAASqD,GAGnBA,EAAIA,GAAKpI,EAAOqI,MAEXD,EAAEE,QAAOF,EAAEE,MAAQF,EAAEG,UAAYH,EAAEI,SACnCJ,EAAErJ,SAAQqJ,EAAErJ,OAASqJ,EAAEK,WAG5B,KACEL,EAAEM,cAAgB3H,EAClB,MAAO4H,IAUT,GARAP,EAAEvH,KAAOkD,EAAIhB,MAAQgB,EAAIhB,MAAQlC,EAG7BsH,EAAQT,KAAK3D,EAAKqE,MAAO,GAAS,cAAcnG,KAAKlB,EAAI2D,QAC3D0D,EAAEQ,gBAAkBR,EAAEQ,iBACtBR,EAAES,aAAc,IAGbT,EAAEU,cAAe,CACpB,GAAIxD,GAAKzE,EAAOkD,EAAI/C,OAAS+C,CAC7BuB,GAAGnC,WAQT,QAAS4F,GAAS1H,EAAMiC,EAAM0F,GACxB3H,IACFA,EAAKO,aAAaoH,EAAQ1F,GAC1BjC,EAAKU,YAAYuB,IAKrB,QAASH,GAAOkB,EAAaN,EAAKlD,GAEhCgE,EAAKR,EAAa,SAASnE,EAAM0C,GAE/B,GAAI7B,GAAMb,EAAKa,IACXkI,EAAW/I,EAAK0E,KAChBM,EAAQ/C,EAAKjC,EAAKA,KAAM6D,GACxB/C,EAASd,EAAKa,IAAIO,UAQtB,IANa,MAAT4D,IAAeA,EAAQ,IAGvBlE,GAA4B,YAAlBA,EAAOiD,UAAuBiB,EAAQA,EAAMyB,QAAQ,SAAU,KAGxEzG,EAAKgF,QAAUA,EAAnB,CAIA,GAHAhF,EAAKgF,MAAQA,GAGR+D,EAAU,MAAOlI,GAAI4D,UAAYO,EAAMgE,UAM5C,IAHAjI,EAAQF,EAAKkI,GAGO,kBAAT/D,GACTgD,EAAgBe,EAAU/D,EAAOnE,EAAKgD,EAAKlD,OAGtC,IAAgB,MAAZoI,EAAkB,CAC3B,GAAInH,GAAO5B,EAAK4B,IAGZoD,GACEpD,IACFiH,EAASjH,EAAKR,WAAYQ,EAAMf,GAChCA,EAAIoI,QAAS,EAGRvB,EAAS7G,IACZsC,EAAKtC,EAAK,SAASuE,GACbA,EAAGe,OAASf,EAAGe,KAAKC,YAAWhB,EAAGe,KAAKC,YAAchB,EAAGe,KAAKe,QAAQ,cAM/EtF,EAAO5B,EAAK4B,KAAOA,GAAQpC,SAAS0J,eAAe,IACnDL,EAAShI,EAAIO,WAAYP,EAAKe,GAC9Bf,EAAIoI,QAAS,OAGV,IAAI,gBAAgBlH,KAAKgH,GACd,QAAZA,IAAoB/D,GAASA,GACjCnE,EAAIsI,MAAMC,QAAUpE,EAAQ,GAAK,WAG5B,IAAgB,SAAZ+D,EACTlI,EAAImE,MAAQA,MAGP,IAA4B,SAAxB+D,EAAS3I,MAAM,EAAG,IAA6B,YAAZ2I,EAC5CA,EAAWA,EAAS3I,MAAM,GAC1B4E,EAAQnE,EAAI2F,aAAauC,EAAU/D,GAASjE,EAAQF,EAAKkI,OAEpD,CACL,GAAI/I,EAAK8E,KAAM,CAEb,GADAjE,EAAIkI,GAAY/D,GACXA,EAAO,MACZA,GAAQ+D,EAGU,gBAAT/D,IAAmBnE,EAAI2F,aAAauC,EAAU/D,OAQ/D,QAASL,GAAKxE,EAAK6F,GACjB,IAAK,GAAqCZ,GAAjC1C,EAAI,EAAG2G,GAAOlJ,OAAWE,OAAgBgJ,EAAJ3G,EAASA,IACrD0C,EAAKjF,EAAIuC,GAEC,MAAN0C,GAAcY,EAAGZ,EAAI1C,MAAO,GAAOA,GAEzC,OAAOvC,GAGT,QAASmJ,GAAWC,GAClB,MAAoB,kBAANA,KAAoB,EAGpC,QAASxI,GAAQF,EAAKgE,GACpBhE,EAAI2I,gBAAgB3E,GAGtB,QAAS8B,GAAQ8C,GACf,OAAQA,EAAMA,GAAM,KAAQA,GAAM,IAGpC,QAASvG,GAAWrC,GAClB,GAAIW,GAAQC,EAAOZ,GACjB6I,EAAW7I,EAAI8C,aAAa,QAC5BI,EAAU2F,GAAYA,EAASpF,QAAQpE,EAAS,IAAM,EAAIwJ,EAAWlI,EAAMqD,IAE7E,OAAOd,GAGT,QAASQ,GAAOoF,GAEd,IAAK,GADDC,GAAKC,EAAOzC,UACP1E,EAAI,EAAGA,EAAImH,EAAKxJ,SAAUqC,EACjC,GAAKkH,EAAMC,EAAKnH,GACd,IAAK,GAAInC,KAAOqJ,GACdD,EAAIpJ,GAAOqJ,EAAIrJ,EAIrB,OAAOoJ,GAGT,QAAS5D,GAAM9E,GACb,GAAI6I,GAAUC,GAAyB,GAAZA,EACvBC,EAAU,gBAAgBC,KAAKhJ,GAC/B8C,EAAUiG,EAAUA,EAAQ,GAAG/D,cAAgB,GAC/CiE,EAAuB,OAAZnG,GAAgC,OAAZA,EAAoB,KAC5B,OAAZA,EAAmB,QAAU,MACxCqB,EAAK+E,EAAKD,EAgBd,OAdA9E,GAAGxD,MAAO,EAENkI,IACc,aAAZ/F,EACFqG,EAAkBhF,EAAInE,GACH,WAAZ8C,EACPsG,EAAgBjF,EAAInE,GACD,QAAZiJ,EACPI,EAAelF,EAAInE,EAAU8C,GAE7B+F,EAAU,GAETA,IAAS1E,EAAGtB,UAAY7C,GAEtBmE,EAGT,QAASjC,GAAKtC,EAAKmF,GACjB,GAAInF,EACF,GAAImF,EAAGnF,MAAS,EAAOsC,EAAKtC,EAAI0J,YAAavE,OAI3C,KAFAnF,EAAMA,EAAI4G,WAEH5G,GACLsC,EAAKtC,EAAKmF,GACVnF,EAAMA,EAAI0J,YAMlB,QAAS7C,GAAS7G,GAChB,KAAOA,GAAK,CACV,GAAIA,EAAIoI,OAAQ,OAAO,CACvBpI,GAAMA,EAAIO,WAEZ,OAAO,EAGT,QAAS+I,GAAKtF,GACZ,MAAOrF,UAASgL,cAAc3F,GAGhC,QAASmC,GAAc/E,EAAM6B,GAC3B,MAAO7B,GAAKwE,QAAQ,2BAA4B3C,GAAa,IAG/D,QAAS2G,GAAGC,EAAUC,GACpB,OAAQA,GAAOnL,UAAUoL,iBAAiBF,GAG5C,QAAS5E,GAAQhF,GACf,QAAS+J,MAET,MADAA,GAAMC,UAAYhK,EACX,GAAI+J,GAGb,QAASrH,GAAS3C,EAAKC,EAAQwB,GAC7BqC,EAAK9D,EAAI+D,WAAY,SAASF,GAC5B,IAAI7D,EAAI0C,WACU,OAAdmB,EAAKG,MAA+B,SAAdH,EAAKG,MAAiB,CAC9ChE,EAAI0C,UAAW,CACf,IAAIqE,GAAG2B,EAAI7E,EAAKM,KAChB,KAAK1C,EAAKgC,QAAQiF,GAAI,MAEtB3B,GAAI9G,EAAOyI,GACN3B,EAGH1F,EAAQ0F,GAAKA,EAAE3D,KAAKpD,GAAQC,EAAOyI,IAAM3B,EAAG/G,GAF5CC,EAAOyI,GAAK1I,KAYpB,QAASyJ,GAAelF,EAAI2F,EAAMhH,GAChC,GAEIvC,GAFAwJ,EAAMb,EAAK,OACXc,EAAQ,QAAQlJ,KAAKgC,GAAW,EAAI,CAMxC,KAHAiH,EAAIlH,UAAY,UAAYiH,EAAO,WACnCvJ,EAAQwJ,EAAIvD,WAELwD,KACLzJ,EAAQA,EAAMiG,UAGhBrC,GAAGpC,YAAYxB,GAIjB,QAAS6I,GAAgBjF,EAAI2F,GAC3B,GAAIG,GAAMf,EAAK,UACXgB,EAAU,wBACVC,EAAU,2BACVC,EAAW,uBACXC,EAAS,qBACTC,EAAY,YACZC,EAAcT,EAAKzK,MAAM6K,GACzBM,EAAgBV,EAAKzK,MAAM8K,GAC3BM,EAAaX,EAAKzK,MAAMiL,GACxBI,EAAYZ,EAAKzK,MAAM+K,GACvBO,EAAUb,EAAKzK,MAAMgL,EAErBI,GACFR,EAAIpH,UAAY4H,EAAW,GAE3BR,EAAIpH,UAAYiH,EAGdS,IACFN,EAAIlG,MAAQwG,EAAY,IAGtBC,GACFP,EAAI1E,aAAa,gBAAiBiF,EAAc,IAG9CE,GACFT,EAAI1E,aAAa,OAAQmF,EAAU,IAGjCC,GACFV,EAAI1E,aAAa,KAAMoF,EAAQ,IAGjCxG,EAAGpC,YAAYkI,GAGjB,QAASd,GAAkBhF,EAAI2F,GAC7B,GAAIG,GAAMf,EAAK,YACX0B,EAAY,wBACZC,EAAc,aACdC,EAAU,cACVC,EAAajB,EAAKzK,MAAMuL,GACxBI,EAAelB,EAAKzK,MAAMwL,GAC1BI,EAAWnB,EAAKzK,MAAMyL,GACtBI,EAAepB,CAEnB,IAAIkB,EAAc,CAChB,GAAIG,GAAUrB,EAAK3K,MAAM6L,EAAa,GAAG5L,OAAO,GAAI6L,EAAS,GAAG7L,OAAO,GAAGgM,MAC1EF,GAAeC,EAOjB,GAJIJ,GACFd,EAAI1E,aAAa,aAAcwF,EAAW,IAGxCG,EAAc,CAChB,GAAIG,GAAWnC,EAAK,MAEpBE,GAAgBiC,EAAUH,GAE1BjB,EAAIlI,YAAYsJ,EAAS7E,YAG3BrC,EAAGpC,YAAYkI,GAcjB,QAASzJ,GAAOZ,GACd,MAAO0L,GAAQ1L,EAAI8C,aAAa6I,IAAa3L,EAAIkD,QAAQkC,eAG3D,QAASwG,GAAYC,GAInB,GAFAC,EAAYA,GAAaxC,EAAK,SAEzB3K,SAASoN,KAAd,CAOA,GALID,EAAUE,WACZF,EAAUE,WAAWC,SAAWJ,EAEhCC,EAAU7I,WAAa4I,GAEpBC,EAAUI,UACb,GAAIJ,EAAUE,WACZrN,SAASwN,KAAKhK,YAAY2J,OACrB,CACL,GAAIM,GAAKxC,EAAG,oBAAoB,EAC5BwC,IACFA,EAAG7L,WAAWM,aAAaiL,EAAWM,GACtCA,EAAG7L,WAAWS,YAAYoL,IAE1BzN,SAASoN,KAAK5J,YAAY2J,GAIhCA,EAAUI,WAAY,GAIxB,QAASG,GAAQ/L,EAAM4C,EAASsB,GAC9B,GAAIxB,GAAM0I,EAAQxI,GAEdD,EAAY3C,EAAKgM,WAAahM,EAAKgM,YAAchM,EAAK2C,SAO1D,OAJA3C,GAAK2C,UAAY,GAEbD,GAAO1C,IAAM0C,EAAM,GAAIf,GAAIe,GAAO1C,KAAMA,EAAMkE,KAAMA,GAAQvB,IAE5DD,GAAOA,EAAIvE,OACbuE,EAAIvE,QACJ8N,EAAWnJ,KAAKJ,GACTA,EAAI/B,GAAG,UAAW,WACvBsL,EAAWvF,OAAOuF,EAAW9I,QAAQT,GAAM,MAJ/C,OA7pCA,GAAI8B,IAAS0H,QAAS,SAAUC,aAK5BC,EAAW,SACXC,EAAW,SAGXtL,EAAUuL,MAAMvL,SAAW,WAC7B,GAAIwL,GAAMrL,OAAOyI,UAAU9B,QAC3B,OAAO,UAAUO,GAAK,MAAuB,mBAAhBmE,EAAIlG,KAAK+B,OAIpCQ,EAAY,SAAW4D,GACzB,MAAkD,IAA1CA,GAAOA,EAAInO,cAAgBoO,cAClC9N,EAEL6F,GAAKC,WAAa,SAASR,GAEzBA,EAAKA,KAEL,IAAIyI,MACAnH,EAAM,CA4DV,OA1DAtB,GAAGtD,GAAK,SAASgM,EAAQ9H,GASvB,MARIsD,GAAWtD,KACbA,EAAGU,IAAuB,mBAAVV,GAAGU,IAAqBA,IAAQV,EAAGU,IAEnDoH,EAAOrH,QAAQ,OAAQ,SAAS5B,EAAMrE,IACnCqN,EAAUhJ,GAAQgJ,EAAUhJ,QAAaZ,KAAK+B,GAC/CA,EAAG+H,MAAQvN,EAAM,KAGd4E,GAGTA,EAAG2C,IAAM,SAAS+F,EAAQ9H,GAcxB,MAbc,KAAV8H,EAAeD,KAEjBC,EAAOrH,QAAQ,OAAQ,SAAS5B,GAC9B,GAAImB,EAEF,IAAK,GAAWgI,GADZC,EAAMJ,EAAUhJ,GACXnC,EAAI,EAAQsL,EAAKC,GAAOA,EAAIvL,KAAOA,EACtCsL,EAAGtH,KAAOV,EAAGU,MAAOuH,EAAIpG,OAAOnF,EAAG,GAAIA,SAG5CmL,GAAUhJ,QAITO,GAITA,EAAGzD,IAAM,SAASkD,EAAMmB,GACtB,QAASlE,KACPsD,EAAG2C,IAAIlD,EAAM/C,GACbkE,EAAGkI,MAAM9I,EAAIgC,WAEf,MAAOhC,GAAGtD,GAAG+C,EAAM/C,IAGrBsD,EAAG8B,QAAU,SAASrC,GAIpB,IAAK,GAAWmB,GAHZ6D,KAAUzJ,MAAMoH,KAAKJ,UAAW,GAChC+G,EAAMN,EAAUhJ,OAEXnC,EAAI,EAAQsD,EAAKmI,EAAIzL,KAAOA,EAC9BsD,EAAGoI,OACNpI,EAAGoI,KAAO,EACVpI,EAAGkI,MAAM9I,EAAIY,EAAG+H,OAASlJ,GAAMwJ,OAAOxE,GAAQA,GAC1CsE,EAAIzL,KAAOsD,GAAMtD,IACrBsD,EAAGoI,KAAO,EAQd,OAJIP,GAAUS,KAAe,OAARzJ,GACnBO,EAAG8B,QAAQgH,MAAM9I,GAAK,MAAOP,GAAMwJ,OAAOxE,IAGrCzE,GAGFA,GAGTO,EAAKwB,MAAQ,WACX,GAAIoH,KAEJ,OAAO,UAAS1J,EAAMsC,GACpB,MAAKA,QACLoH,EAAO1J,GAAQsC,GADIoH,EAAO1J,OAM7B,SAAUc,EAAMF,EAAK3F,GAWpB,QAAS0O,KACP,MAAOC,GAAIC,KAAK3J,MAAM,KAAK,IAAM,GAGnC,QAAS4J,GAAOC,GACd,MAAOA,GAAK7J,MAAM,KAGpB,QAAS8J,GAAKD,GACRA,EAAKpK,OAAMoK,EAAOJ,KAElBI,GAAQE,IACVX,EAAIjH,QAAQgH,MAAM,MAAO,KAAKG,OAAOM,EAAOC,KAC5CE,EAAUF,GArBd,GAAK9O,EAAL,CAEA,GAIIgP,GAJAL,EAAM3O,EAAOiP,SACbZ,EAAMxI,EAAKC,aACX+H,EAAM7N,EACNkP,GAAU,EAoBVC,EAAItJ,EAAKuJ,MAAQ,SAASC,GAExBA,EAAI,IACNV,EAAID,KAAOW,EACXN,EAAKM,IAILhB,EAAIrM,GAAG,IAAKqN,GAIhBF,GAAEhF,KAAO,SAASjE,GAChBA,EAAGkI,MAAM,KAAMS,EAAOH,OAGxBS,EAAEN,OAAS,SAAS3I,GAClB2I,EAAS3I,GAGXiJ,EAAEG,KAAO,WACFJ,IACLrB,EAAI0B,oBAAsB1B,EAAI0B,oBAAoB5J,EAAKoJ,GAAM,GAASlB,EAAI2B,YAAY,KAAO7J,EAAKoJ,GAClGV,EAAIpG,IAAI,KACRiH,GAAU,IAGZC,EAAEM,MAAQ,WACJP,IACJrB,EAAI6B,iBAAmB7B,EAAI6B,iBAAiB/J,EAAKoJ,GAAM,GAASlB,EAAI8B,YAAY,KAAOhK,EAAKoJ,GAC5FG,GAAU,IAIZC,EAAEM,UAED5J,EAAM,aAAc7F,EAwCvB,IAs6BI6M,GAt6BAzM,EAAW,SAAUwP,GAEvB,GAAIC,GACAV,EACAW,EACAC,EAAK,OAET,OAAO,UAASC,GAGd,GAAIC,GAAIpK,EAAK2H,SAASpN,UAAYwP,CAUlC,OAPIC,KAAmBI,IACrBJ,EAAiBI,EACjBH,EAAIG,EAAEhL,MAAM,KACZkK,EAAIW,EAAErN,IAAI,SAAU2F,GAAK,MAAOA,GAAEzB,QAAQ,SAAU,SAI/CqJ,YAAaE,QAChBD,IAAML,EAAOI,EACb,GAAIE,QAAOF,EAAEG,OAAOxJ,QAAQoJ,EAAI,SAASD,GAAK,MAAOX,MAAW,MAANW,MAAgBE,EAAEI,OAAS,IAAM,IAG7FN,EAAEE,KAEL,OAGC7N,EAAO,WAoBT,QAASA,GAAK8N,EAAGnI,GAYf,MATAmI,IAAKA,GAAM7P,EAAS,GAAKA,EAAS,IAG/BuG,QAAQvG,EAAS,QAAS,KAC1BuG,QAAQvG,EAAS,QAAS,KAG7B0H,EAAI7C,EAAMgL,EAAGI,EAAQJ,EAAG7P,EAAS,KAAMA,EAAS,OAEzC,GAAIkQ,UAAS,IAAK,WAGtBxI,EAAE,IAAOA,EAAE,IAAOA,EAAE,GAMjB,IAAMA,EAAErF,IAAI,SAASwN,EAAGrN,GAGxB,MAAOA,GAAI,EAGL1C,EAAK+P,GAAG,GAGR,IAAMA,EAGHtJ,QAAQ,MAAO,OAGfA,QAAQ,KAAM,OAEf,MAEP4J,KAAK,KAAO,aAtBbrQ,EAAK4H,EAAE,KA0BVnB,QAAQ,UAAWvG,EAAS,IAC5BuG,QAAQ,UAAWvG,EAAS,IAE7B,KAOJ,QAASF,GAAK+P,EAAGO,GAUf,MATAP,GAAIA,EAGDtJ,QAAQ,MAAO,KAGfA,QAAQvG,EAAS,8BAA+B,IAG5C,mBAAmB6B,KAAKgO,GAI3B,IAGEI,EAAQJ,EAGJ,uBAGA,iCACExN,IAAI,SAASgO,GAGb,MAAOA,GAAK9J,QAAQ,kCAAmC,SAAS+J,EAAGC,EAAGlH,GAGpE,MAAOA,GAAE9C,QAAQ,cAAeiK,GAAQ,KAAOD,EAAI,YAIpDJ,KAAK,IAEZ,qBAGFK,EAAKX,EAAGO,GAOd,QAASI,GAAKX,EAAGY,GAEf,MADAZ,GAAIA,EAAE1D,OACE0D,EAAS,uBAGVA,EAAEtJ,QAAQmK,EAAQ,SAASb,EAAGS,EAAGjH,GAAK,MAAOA,GAAI,MAAMA,EAAE,iBAAkC,mBAAVzJ,GAAwB,UAAY,WAAWyJ,EAAE,MAAMA,EAAE,IAAMwG,KAG9I,KACL,8BAIGY,KAAW,EAAO,iBAAmB,KAExC,cAbQ,GAmBd,QAAS5L,GAAM8L,EAAKC,GAClB,GAAIC,KAUJ,OATAD,GAAWvO,IAAI,SAASyO,EAAKtO,GAG3BA,EAAImO,EAAIvM,QAAQ0M,GAChBD,EAAM9M,KAAK4M,EAAIzQ,MAAM,EAAGsC,GAAIsO,GAC5BH,EAAMA,EAAIzQ,MAAMsC,EAAIsO,EAAI3Q,UAInB0Q,EAAM1C,OAAOwC,GAMtB,QAASV,GAAQU,EAAKI,EAAMC,GAE1B,GAAI3B,GACA4B,EAAQ,EACRnH,KACA6F,EAAK,GAAIG,QAAO,IAAIiB,EAAKhB,OAAO,MAAMiB,EAAMjB,OAAO,IAAK,IAe5D,OAbAY,GAAIpK,QAAQoJ,EAAI,SAASW,EAAGS,EAAMC,EAAO1Q,IAGlC2Q,GAASF,IAAM1B,EAAQ/O,GAG5B2Q,GAASF,EAAO,EAAI,GAGfE,GAAkB,MAATD,GAAelH,EAAQ/F,KAAK4M,EAAIzQ,MAAMmP,EAAO/O,EAAI0Q,EAAM7Q,WAIhE2J,EAhLT,GAAIoH,MACAR,EAAS,oIAUb,OAAO,UAASC,EAAK5J,GACnB,MAAO4J,KAAQO,EAAMP,GAAOO,EAAMP,IAAQ5O,EAAK4O,IAAM5J,OAw3BrDmG,KACAb,KAGAC,EAAW,UAsDf7G,GAAK9B,IAAM,SAASgB,EAAMkG,EAAM2B,EAAKrG,EAAOL,GAa1C,MAZIsD,GAAWjD,KACbL,EAAKK,EACD,eAAetE,KAAK2K,IACtBrG,EAAQqG,EACRA,EAAM,IACDrG,EAAQ,IAEbqG,IACEpD,EAAWoD,GAAM1G,EAAK0G,EACrBD,EAAYC,IAEnBH,EAAQ1H,IAAUA,KAAMA,EAAM5C,KAAM8I,EAAM1E,MAAOA,EAAOL,GAAIA,GACrDnB,GAGTc,EAAKrG,MAAQ,SAASoL,EAAU3G,EAASsB,GAQvC,QAASgM,GAAYpD,GACnB,GAAIqD,GAAO,EAIX,OAHA3M,GAAKsJ,EAAK,SAAU/F,GAClBoJ,GAAQ,iBAAkBpJ,EAAEmE,OAAS,OAEhCiF,EAGT,QAASC,KACP,GAAIjP,GAAOD,OAAOC,KAAKiK,EACvB,OAAOjK,GAAO+O,EAAY/O,GAG5B,QAASkP,GAASrQ,GAChB,GAAIA,EAAK4C,QAAS,CACZA,IAAY5C,EAAKwC,aAAa6I,IAChCrL,EAAKqF,aAAagG,EAAUzI,EAE9B,IAAIF,GAAMqJ,EAAQ/L,EAChB4C,GAAW5C,EAAKwC,aAAa6I,IAAarL,EAAK4C,QAAQkC,cAAeZ,EAEpExB,IAAKtC,EAAK0C,KAAKJ,OAEZ1C,GAAKd,QACZsE,EAAKxD,EAAMqQ,GA9Bf,GAAIrR,GACAsR,EACAlQ,IAwDJ,UAtBWwC,KAAYyJ,IACrBnI,EAAOtB,EACPA,EAAU,SAID2G,KAAa6C,GACL,MAAb7C,EAGFA,EAAW+G,EAAUF,IAGrB7G,GAAY2G,EAAY3G,EAAS3F,MAAM,MAEzC5E,EAAMsK,EAAGC,IAITvK,EAAMuK,EAGQ,MAAZ3G,EAAiB,CAInB,GAFAA,EAAU0N,GAAWF,IAEjBpR,EAAI4D,QACN5D,EAAMsK,EAAG1G,EAAS5D,OACb,CAEL,GAAIuR,KACJ/M,GAAKxE,EAAK,SAAUwR,GAClBD,EAASzN,KAAKwG,EAAG1G,EAAS4N,MAE5BxR,EAAMuR,EAGR3N,EAAU,EAQZ,MALI5D,GAAI4D,QACNyN,EAASrR,GAETwE,EAAKxE,EAAKqR,GAELjQ,GAIToE,EAAK1C,OAAS,WACZ,MAAO0B,GAAKyI,EAAY,SAASvJ,GAC/BA,EAAIZ,YAKR0C,EAAKuH,QAAUvH,EAAKrG,MAIlBqG,EAAKiM,MAAS1R,SAAUA,EAAU+B,KAAMA,GAGjB,gBAAZ4P,SACTC,OAAOD,QAAUlM,EACQ,kBAAXoM,SAAyBA,OAAOC,IAC9CD,OAAO,WAAa,MAAOpM,KAE3B7F,EAAO6F,KAAOA,GAEE,mBAAV7F,QAAwBA,OAASgI;AQhyCvC,ATFJ,OAAO,CAAC,ESEE,GPFkB,CAAC,AFAf,CEAgB,AOEf,ATFA,CSEC,ATFA,KEAoB,AFAf,CAAC,GAAG,CAAC,CAAA,USEW,CAAC,CAAC;AVPvC,GUQG,EPHiC,CAAC,CAAC;AAClC,AFCJ,IAAM,IEDE,EFCI,CEDD,EFCI,EEDA,CAAC,CAAC,CAAC,CAAC,CFCG,CAAC,gBAAgB,CAAC,CAAC;ASGvC,ATFF,AWcA,IXdM,ESEE,ETFE,AWcDsM,EFZG,CTFC,CACX,CSCa,IAAI,CAAC,ETDV,CAAC,GSCe,CAAC,IEYGC,EAAQhP,GXbd,AWctBiP,CFbmC,ATDZ,GSCe,EAAE,CEajCD,GXdyB,AWgBhChP,CXhBiC,CWgB1BkP,CXfP,QAAQ,AWeQlP,CXfP,KWiBT,IAwEImP,GAxEAC,CXjBkB,CAAC,AWiBXC,MXjBiB,CAAC,AWkB1BC,CXjBL,CAAA,AWiB0B,SAAdtP,EAAKuP,KACZC,EAAOxP,EAAKwP,KACZC,EAAUC,mBAAmBF,GAC7B5E,EAAS+C,KAAKgC,OAAO,WACvB,MAAO,SAASrL,GAAIsL,EAAKjH,GAGvB,QAASkH,GAAMC,GAAOnH,EAAG,EAAGmH,GAFxBxL,EAAIyL,MACRzL,EAAIyL,KAAM,EAEVf,EAAOvS,GAAG,UAAWoT,SAGrBG,EAASrC,KAAKsC,KAAK,SAAUC,GAC/B,QAASL,GAAKD,EAAKhO,GACjB,MAAIgO,IACFA,EAAMH,EAAQ9B,KAAK1O,QAAQ4Q,EAAKjG,UAC1BgG,GAAKH,EAAQ9B,KAAKnL,OAAOoN,EAAK,KAGlCZ,EAAOmB,WAAa,EACfD,EAAK/B,MAAM,iBAAkB0B,IAEtCb,EAAOL,KAAK/M,GAER0N,EAAac,aAAaF,EAAM,EAAGL,QACvCA,EAAKjG,EAAI,WAAcsG,EAAKN,EAAKC,MAGnCK,EAAK,KAAM,SAAUN,EAAKhO,GACxBiO,EAAKD,EAAKhO,GACV6N,EAAQ9B,KAAK/O,KAAKiR,EAAKjG,OAIvByG,EAAY1C,KAAK2C,QAAQ,SAAUJ,GACrC,MAAO,SAAS5L,GAAIsL,EAAKjH,GACvB,MAA0B,KAAtBqG,EAAOmB,WACFnB,EAAOvS,GAAG,OAAQ,WACvB6H,EAAIsL,EAAKjH,SAGbuH,GAAK,KAAM,SAAUN,EAAKhO,GACxBsO,EAAKN,EAAKjH,QAIZ4H,EAAclC,OAAO,SAAUyB,GAC/B,MAAOL,GAAQK,OAEfU,EAAgB9B,OAAO,WACpBY,GAAMN,EAAOL,KAAK,GAAIa,GAAKiB,QAAQC,WAEtCC,EAAUjC,OAAO,SAAU9M,GAC7B,MAAOyJ,MAAKzJ,EAAM4N,OAEhBoB,GACF7T,UAAW2R,OAAO,SAAU9M,GAC1B,MAAOA,KACJA,EAAKiP,cAAgB7T,QAAUoL,MAAMvL,QAAQ+E,IAC5C9E,KAAKC,UAAU6E,GACfA,MAENkP,MAAOpC,OAAO,SAAU9M,EAAM+G,GAC5B,IACEA,EAAG,KAAM7L,KAAKgU,MAAMlP,IACpB,MAAOiB,GACP8F,EAAG9F,SAKLkO,EAAU3B,EAAMxE,EAqEpB,OAlEAmG,GAAQvC,QAAQ,GAAGC,KAAK8B,GACxBQ,EAAQxC,QAERa,EAAM4B,MACN5B,EAAMY,KACNZ,EAAMY,KAENb,EAASkB,IACN5B,KAAKC,OAAO,SAAU9M,GACrB,MAAuB,gBAATA,GAAoBA,EAAK,GAAKA,OAE7C6M,KAAKW,EAAMZ,QAAQ,IAEtBW,EAAO8B,QAAUL,EACd7T,UACA0R,KAAKyC,OAAOb,IACV5B,KAAKW,EAAMZ,QAAQ,QAGxBW,EAAOvE,OAASmG,EACbvC,QAAQ,GACRC,KAAKkC,GACLlC,KAAK+B,GAERrB,EAAO8B,QAAQrG,OAASmG,EACrBvC,QAAQ,GACRC,KAAKmC,EAAKE,OACVrC,KAAK+B,GAERrB,EAAOf,KAAOe,EAAOvN,KAAOuN,EAAO8B,QAAQrP,KAAOuN,EAElDA,EAAO8B,QAAQ7C,KAAOe,EAAO8B,QAE7B9B,EAAOV,KAAO,SAAU0C,GACtB,MAAOhC,GAAOvE,OAAO6D,KAAK0C,IAG5BhC,EAAO8B,QAAQxC,KAAO,SAAU0C,GAC9B,MAAOhC,GAAO8B,QAAQrG,OAAO6D,KAAK0C,IAGpChC,EAAOZ,MAAQwC,EACf5B,EAAOiC,IAAMhC,EAEbA,EAAMiC,OAAO,GAMbjC,EAAMZ,QAAW,SAAUA,GACzB,MAAO,UAAoBvD,GAEzB,MADKmE,GAAMkC,SAASrG,EAAE,IAAImE,EAAMY,KACzBxB,EAAQvD,KAEjBmE,EAAMZ,SAERuC,EAAQvC,QAAW,SAAUA,GAC3B,MAAO,UAAsBvD,GAC3B,GAAIiD,GAAOM,EAAQvD,GACfkG,EAASjD,EAAKO,KAAK+B,EAEvB,OADAW,GAAOI,UAAYrD,EACZiD,IAETJ,EAAQvC,SAEH0C,OAAO/B,GAMhB,QAAST,QAAQ/N,GACf,MAAOuQ,QAAOvD,KAAK2C,QAAQ,SAAUJ,GACnC,MAAO,UAAUN,EAAKjH,GACpBuH,EAAK,KAAM,SAAUN,EAAKhO,GACxB,GAAI4P,EACJ,OAAI7Q,GAAG3F,OAAS,GACdwW,EAAW7Q,EAAGiB,OACd+G,GAAGiH,EAAyB,mBAAb4B,GAA2BA,EAAW5P,QAGvDjB,GAAGiB,EAAM,SAAUgO,EAAK4B,GACtB7I,EAAGiH,EAAyB,mBAAb4B,GAA2BA,EAAW5P,aAO/D,QAASyM,QAAO1N,GACd,MAAOgN,MAAKsC,KAAK,SAAUC,GACzBA,EAAK,KAAM,SAAUN,EAAKhO,IACpBgO,GAAOjP,EAAGiB,KAAOoN,OAAOnD,YAKlC,QAAS6D,oBAAmBF,GAC1B,QAASiC,GAAIC,EAASxB,GAEpB,MADAwB,GAAU,GAAKlC,GAAKkC,GAAU,IACxBC,KAAK1S,QAAQyS,GACfA,IAAYD,EAAIG,IAAYH,EAAIG,QACpCH,GAAI9D,KAAK/T,QAAQ,SAAU+G,GAAKA,MAFhC,OAOF,MAFA8Q,GAAI9D,QAEG8D,EAjNTzX,QAAQ,qBACR,IAAI2T,MAAO3T,QAAQ,aACfqV,KAAOrV,QAAQ,aACf6X,MAAQ7X,QAAQ,eAChByX,IAAMzX,QAAQ,eACd8X,QAAU9U,OAAOC,KAAKwU,KACtBE,KAAOG,QAAQ5U,IAAI,SAAS8Q,GAC9B,MAAOyD,KAAIzD,KAETyC,QAAUqB,QAAQC,OAAO,SAAUC,EAAG5G,GAExC,MADA4G,GAAE5G,IAAM,EAAGqG,IAAIrG,IACR4G,OAELhB,KAAOa,MAAMb,KACb3F,KAAOwG,MAAMxG,KACb6F,OAASW,MAAMX,OACfjC,OAAS4C,MAAM5C,OACfC,SAAW2C,MAAM3C,QAErBzC,QAAOD,QAAUuC,oBACjBtC,OAAOD,QAAQ+E,UAAYvX,QAAQ,aAsJnC+U,oBAAoBL,OAASA,OAC7BK,oBAAoBV,OAASA;ATnKzB,AOGA,QPHI,EOGE,CAAC,GPHG,CAAC,EOGE,CAAC,CPHC,CAAC,GOGG,EAAE,GAAG,CAAC,CAAC,EPHE,QAAQ,EAAE;AACrC,AOGD,AGZJ,IZaO,IYbE2C,CHYA,CAAC,CTCI,CEJH,CAAC,CFIY,ESDR,CPHA,AURhB,CVQiB,AOGC,ATCU,CSDT,CPHA,CAAC,IURX3F,MAAKzJ,EAAM4N,GAClB,MAAuB,gBAAT5N,GACZA,EACA,GAAI4N,GAAK5N,GAEb,QAASsP,QAAO/B,GACd,MAAO,UAAgBI,GACrB,MAAOA,KAASvS,OAASmS,EAAO8B,QAAU9B,GAG9C,QAASF,QAAOD,GACdA,EAAOiD,WAAa,cACpBjD,EAAOvS,GAAKuS,EAAOvS,IAAM,SAAUyV,EAAOvR,GACxC,QAASgI,GAAG9F,GACVlC,EAAGkC,EAAEjB,MAAQiB,GAEflC,EAAGgI,GAAKA,EACRqG,EAAO7E,iBAAiB+H,EAAOvJ,IAEjCqG,EAAOmD,eAAiBnD,EAAOmD,gBAAkB,SAAUD,EAAOvR,GAChEqO,EAAOhF,oBAAoBkI,EAAOvR,EAAGgI,IAAMhI,IAG/C,QAASuO,UAASlP,GAEhB,MADAA,GAAKwP,KAAOxP,EAAKwP,MAAQ/U,OAAOmU,YAAcwD,OACvCpS,EAETyM,OAAOD,SACLwE,KAAMA,KACN3F,KAAMA,KACN6F,OAAQA,OACRjC,OAAQA,OACRC,SAAUA;GHpBT,CAAC,ATAY,CEHZ,AOGC,GTAe,GAAI,IAAI;AeW5B,GbbG,CAAC,CAAA,GaaKoE,SAAQpD,GACf,MAAG,kBAAsBA,GAChBA,GAETA,EAAKzB,KAAOyB,EAAKzB,MAAQ,SAAU8E,GACjC,GAAG,kBAAqBA,IAAU,kBAAqBA,GAAOnF,KAC5D,KAAM,IAAID,OAAM,sBAClB,IAAIM,GAAO6E,QAAQC,EAAOnF,KAAOmF,EAAOnF,KAAK8B,GAAQqD,EAAOrD,GAC5D,OAAOqD,GAAO3I,QAAU6D,GAG1ByB,EAAK/Q,KAAO,SACL+Q,GApCT1D,QAAQgH,GACR,SAAUlY,GACR,MAAOA,IAGTkR,QAAQiH,KACR,SAAUvW,GACR,GAAG,gBAAmBA,GAAK,CACzB,GAAIhC,GAAMgC,CACV,OAAO,UAAU0E,GAAQ,MAAOA,GAAK1G,IAEvC,MAAOgC,IAGTsP,QAAQkH,OAAS,SAAUhX,GACzB,MAAIA,GACD,gBAAoBA,IAClB,kBAAsBA,GAAKA,KACrBA,EAAKA,KAAKuF,KAAKvF,GACnB8P,QAAQiH,KAAK/W,IAAS8P,QAAQgH,GAJpBhH,QAAQgH,IAO3BhH,QAAQ8G,QAAUA,OAiBlB,IAAI3D,QACJnD,QAAQmD,OACR,SAAiBgE,GACf,QAASjJ,KACP,GAAIlG,MAAUzJ,MAAMoH,KAAKJ,UACzB,OAAOuR,SAAQK,EAAW9K,MAAM,KAAMrE,IAGxC,MADAkG,GAAEvL,KAAO,SACFuL,GAIL4F,QACJ9D,QAAQ8D,QACR,SAAUqD,GACR,MAAO,YAGL,QAASJ,GAAQrD,GAGf,IAFA1L,EAAKoP,QAAQ1D,GACbA,EAAOyD,EAAW9K,MAAM,KAAMrE,GACxBqP,EAAM7Y,QACVkV,EAAO2D,EAAMC,QAAQ5D,EACvB,OAAOA,GAPT,GAAI1L,MAAUzJ,MAAMoH,KAAKJ,WACrB8R,IAiBJ,OARAN,GAAO9E,KAAO,SAAUyB,GAEtB,GADA2D,EAAMjV,KAAKsR,GACM,WAAdA,EAAK/Q,KACN,KAAM,IAAIgP,OAAM,eAAiBoF,EAAOpU,KAAO,aAEjD,OADAoU,GAAOpU,KAAqB,SAAd+Q,EAAK/Q,KAAkB,OAAS,UACvCoU,GAETA,EAAOpU,KAAO,UACPoU,IAIPtD,KACJzD,QAAQyD,KACR,SAAc8D,GACZ,MAAO,YAIL,QAASrJ,GAAGwF,GAEV,MADA1L,GAAKoP,QAAQ1D,GACN6D,EAAalL,MAAM,KAAMrE,GALlC,GAAIA,MAAUzJ,MAAMoH,KAAKJ,UACzB,KAAIgS,EACF,KAAM,IAAI5F,OAAM,gCAMlB,OADAzD,GAAEvL,KAAO,OACFuL,GAKX8B,SAAQwH,UACRxH,QAAQyH,WACR,SAAUC,EAAYvL,GACpB,MAAIA,GAeGsH,KAAK,SAAUC,GACpB,MAAOgE,GAAWvL,GAAKuH,OAfhBI,QAAQ,SAAUJ,GACvB,GAAIiE,EACJ,OAAO,UAAUtI,EAAOlD,GACtB,MAAGkD,GAAcqE,EAAKrE,EAAOlD,GAC1BwL,EAAcxL,EAAGwL,OAEpBD,GAAW,SAAUE,EAAKxS,GACxBuS,EAAQC,IAAO,EACXA,EACKzL,EAAGwL,GADHxL,EAAG,KAAM/G,KAEhBsO;AN7FV,ATCF,CEHC,CAAA,IOEK,ATCA,CAAC,ESDE,YAAY,QAAQ,EAAE;AAC3B,ATCF,Aa8CF,QAASmC,Cb9CA,ESDE,GAAG,CACP,EI8CU7D,EAAS8C,CJ9Cd,CAAC,CI+CX,MJ/CkB,AI+CX,CJ/CY,IAAI,CAAC,CACnB,IAAI,CAAC,AI+CN,GAAIgB,CJ/CM,CAAC,CI+CF9D,EAAQ+D,GJ/CA,CAAC,CIgDlB/D,EJhDqB,CAAC,AIgDdgE,EJhDgB,CAAC,CACxB,IAAI,AIgDLlB,CJhDM,CIgDGvW,GJhDC,EAAE,CAAC,AIgDEuX,CJhDD,EIgDK1Y,QAAQ,SAAU8Q,GACnCA,EAAE6H,OAAS,IAEbjB,EAAS9O,OAAO8P,EAAI,IAtE1B,GAAI3E,MAAO3T,QAAQ,aACfyY,OAASzY,QAAQ,gBACjB0Y,QAAU/E,KAAKsC,KAAK,SAASC,GAC/BA,EAAK,EAAG,QAASL,GAAKD,EAAK+C,GAErB/C,GACJM,EAAKN,EAAKC,OAIV+C,gBAAkBjF,KAAKgC,OAAO,WAEhC,QAASnB,GAASoB,EAAKjH,GACjBiH,IACCiD,EAAI5T,QAAQ0J,IACjBkK,EAAIjU,KAAK+J,GAJX,GAAImK,GAASD,IAYb,OANArE,GAAQgE,MAAQ,WAAcM,GAAU,GACxCtE,EAAQqB,KAAO,SAAUjO,GACvBiR,EAAIjZ,QAAQ,SAAU+O,GACpBA,EAAGmK,EAASlR,MAGT4M,IAGL4C,IAAMzD,KAAK2C,QAAQ,SAAUJ,EAAMiB,EAAQoB,GAE7C,QAASQ,GAAQnD,EAAKjH,GAChBiH,GACJM,EAAK,EAAG,SAAUN,EAAKhO,GACjBgO,GACJjH,EAAGmK,GAAWlD,EAAK6C,OAAO7Q,EAAM2Q,MALpC,GAAIO,EASJ,OADAC,GAAQP,MAAQ,WAAcM,GAAU,GACjCC,IAGLxE,MAAQZ,KAAK2C,QAAQ,SAAUJ,EAAMiB,EAAQG,EAAUD,GACzD,QAAS2B,GAAKpD,EAAKjH,GACbiH,GACJM,EAAK,EAAG,SAAUN,EAAKhO,GACrB,IAAIgO,EAAJ,CACA,GAAIqD,GAAUR,OAAO7Q,GACjBsM,EAAO+E,EAAQ/E,IACnBA,IAAQmD,EAAO6B,GACf5B,EAASpD,GAAQ8E,EAAKxE,QAAQN,GAC9BoD,EAASpD,GAAM2B,KAAKoD,EAAQrR,MAC5B+G,EAAGiH,EAAKhO,MAWZ,MAPAoR,GAAK1B,SAAWA,EAChB0B,EAAKxE,QAAW,SAAUN,GAExB,MADAA,IAAQmD,EAAO6B,GACR5B,EAASpD,KACboD,EAASpD,GAAQ0E,oBAGfI,GAcTvG,QAAOD,QAAU,WAGf,QAAS4C,GAAM+B,GACb,GAAImB,GAAI9D,CAER,OAAoB,WAAhB2C,EAAOhS,MACTgS,EAASA,EAAO1C,KAAKF,MAAM4C,EAAQgC,EAAW9B,IAC9CF,EAAO5C,MAAQ,QAASA,KACtB,MAAQA,GAAM6E,GAAK7E,EAAM6E,IAAMjC,EAAO1C,KAAKiE,YAEtCvB,IAETmB,EAAKhB,EAAStW,OACdwT,EAAU4C,IAAID,EAAQmB,GAAI7D,KAAK0C,GAC/B3C,EAAQzU,OAASsY,QAAQ7D,EAAS8C,GAElCA,EAAS1S,KAAK4P,GAEPA,GAYT,QAAS6C,GAAOpG,GACdoG,EAAO6B,GAAKjI,EA/Bd,GAAIqG,MAAe6B,IAmCnB,OAdA/D,GAAMkC,SAAWA,EAEjBlC,EAAMZ,QAAU,SAAUN,GACxB,MAAOoD,GAASpD,EAAOmD,EAAO6B,KAGhC9D,EAAMiC,OAASA,EAEfA,EAAO6B,GAAK,EAML9D;GJ1FN;AOpBH,GAAIiF,QAASra,QAAQ,mBACjBsa,OAASta,QAAQ,SAErByS,QAAOD,QAAU,SAAS5K,EAAMsM,GAC9B,GAAIqG,GAAOC,CACX,OAAoB,gBAAT5S,GACFyS,OAAOxL,MAAM,EAAG9G,YAGzBH,EAAO,GAAIgN,YAAWhN,EAAK6S,QAAU7S,GAEjCG,UAAU/G,OAAS,GACnBwZ,EAASF,OAAOI,eAAexG,GAC/BqG,EAAQ,GAAI3F,YAAW,GAAI+F,aAAY/S,EAAKgT,WAAaJ,IACzDF,OAAOO,OAAO3G,EAAMqG,GACpBA,EAAMO,IAAIlT,EAAM4S,GACTD,EAAME,SAIfvG,KAAMoG,OAAOS,OAAOnT,GACpBA,KAAMA,EAAK6S,OAAO1Z,MAAMuZ,OAAOS,OAAOC;APCxC,SAAO,GAAG,CACP,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CACnB,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;AQxBlB,CRyBC,CAAA,CQzBGV,QAASta,QAAQ,UACjBib,KAAO7C,OAAO8C,aAAa,IAE/BzI,QAAOD,QAAU,SAAU5K,EAAMsM,GAE/B,GAAInM,UAAU/G,OAAS,EACrB,MAAOsZ,QAAOO,OAAO3G,GAAMhR,IAAI,SAAU+N,GACvC,MAAOmH,QAAO8C,aAAajK,KAC1BD,KAAK,IAAMpJ,CAGhB,KADA,GAAIuT,GAAkB,IACbA,GAAoBvT,EAAKuT,KAAqBF,OAGvD,MAFAE,IAAmB,GAGjBjH,KAAMoG,OAAOS,OAAOnT,EACjB7G,MAAM,EAAGoa,GACTzV,MAAM,IACNxC,IAAI,SAAUwN,GAAK,MAAOA,GAAEuD,WAAW,MAC1CrM,KAAMA,EAAK7G,MAAMuZ,OAAOS,OAAOC;;ARQnC,AYtBA,MZsBM,CAAC,CYtBE9E,MZsBK,AYtBAiG,CZsBC,CYtBI9E,GZsBA,AYrBjB,GZqBoB,AYjBhB9G,GAJA6L,EAAS,EACT/E,EAASA,CZoBQ,EYpBE,EZoBE,AYnBrByC,EZmB0B,AYnBjB,EACTuC,EAAUhF,EAEViF,EAAIH,EAAInb,MAEZ,GAAG,CACD,GAAGqb,GAAWC,EAEZ,YADApG,KAAKqG,UAAY,EAGnBhM,GAAI4L,EAAIE,KACRD,GAAe,GAARtC,GACFvJ,EAAImL,OAAS5B,GACbvJ,EAAImL,MAAQjU,KAAKkU,IAAI,EAAG7B,GAC7BA,GAAS,QACFvJ,GAAKiL,IAId,OAFAtF,MAAK8E,MAAQqB,EAAUhF,EAEhB+E,EA3BT3J,OAAOD,QAAU0D,IAEjB,IAAIsF,KAAM,IACNE,KAAO;AZyBT,MAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;AAC5B,AUtBJ,QAASb,EVsBC,KAAK,CAAC,AUtBAO,EAAKC,EAAKhE,GACxBgE,EAAMA,MACNhE,EAASA,GAAU,CVoBgB,AUjBnC,CViBoC,CAAC,GUnBrC,GAAIiE,GAAYjE,EAEV+D,GAAOG,KACXF,EAAIhE,KAAmB,IAAN+D,EAAcI,IAC/BJ,GAAO,GAET,MAAMA,EAAMK,QACVJ,EAAIhE,KAAmB,IAAN+D,EAAcI,IAC/BJ,KAAS,CAMX,OAJAC,GAAIhE,GAAgB,EAAN+D,EAEdP,OAAOG,MAAQ3D,EAASiE,EAAY,EAE7BD,EAxBT5I,OAAOD,QAAUqI,MAEjB,IAAIW,KAAM,IACNE,KAAO,IACPD,QAAUC,KACVH,IAAM9T,KAAKkU,IAAI,EAAG;GVyBnB;AS9BHlJ,KlBiBS,EkBjBFD,SACHqI,ClBgBQ,MkBhBA7a,QAAQ,eAChB+a,OAAQ/a,QAAQ,eAChB0a,eAAgB1a,QAAQ;AT6B1B,ATfY,ISeV,CAAC,ETfY,CAAC,CSeT,CAAC,IAAI,CTfW,CAAC,CAAC,OSeH,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AW/B5C,CXgCC,CAAA,CThB4B,AoBhBzB4b,CpBgByB,GoBhBpBnU,KAAKkU,IAAI,EAAI,GAClBE,GAAKpU,KAAKkU,IAAI,EAAG,IACjBG,GAAKrU,KAAKkU,IAAI,EAAG,IACjBI,GAAKtU,KAAKkU,IAAI,EAAG,IACjBK,GAAKvU,KAAKkU,IAAI,EAAG,IACjBM,GAAKxU,KAAKkU,IAAI,EAAG,IACjBO,GAAKzU,KAAKkU,IAAI,EAAG,GAErBlJ,QAAOD,QAAU,SAAU7M,GACzB,MACUiW,IAARjW,EAAa,EACLkW,GAARlW,EAAa,EACLmW,GAARnW,EAAa,EACLoW,GAARpW,EAAa,EACLqW,GAARrW,EAAa,EACLsW,GAARtW,EAAa,EACLuW,GAARvW,EAAa,EACA;ApBAf,MAAI;ASiBN,AKnCA,GAAIkL,GLmCE,CAAC,IKnCO,GLmCA,CAAC,GAAG,GAAG,CKnCI,ELmCD,CAAC,GKnCOrK,QAChCiM,QAAOD,QAAU,WACf3B,OAAOuF,aAAevF,OAAOuF,cAAgB,WAC3C,GAAI5L,MAAUzJ,MAAM8N,MAAM9G,UAC1ByC,GAAKhC,OAAO,EAAG,EAAG,GAClB6Q,WAAWxK,MAAM,KAAMrE;AL+B3B,MAAM,CAAC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;YDpC3B,IAAMyI,MAAOjT,QAAQ,oBACfkT,MAAQlT,QAAQ,4BAGpBmT,QAGED,MAHFC,QACAC,QAEEF,MAFFE,QACAC,MACEH,MADFG,KAGFZ,QAAOD,QAAU,SAACQ,GAEhBA,EAAMO,QAAU,WACdN,KAAKO,KAAKL,UAGZH,EAAMS,QAAU,WACdR,KAAKO,KAAKJ,UAGZJ,EAAMU,MAAQ,WACZT,KAAKO,KAAKH;;AApBd,AJAA,GAAI/M,CIAE,IAAI,CJACtG,EIAE,MJAM,CIAC,CAAC,KJCrByS,QAAOD,KIDgC,CAAC,CAAC,CJCxBlM,KAAK9B,IAAI,gBAAiB,oeAAqe,6SAA8S,SAASwB,GAAQhG,QAAQ,UAAUwG;AIAj2B,IAAM,KAAK,GAAG,OAAO,CAAC,0BAA0B,CAAC,CAAC;wIDD5CyM,KAAOjT,QAAQ,oBACfkT,MAAQlT,QAAQ,4BAGpBmT,QAGED,MAHFC,QACAC,QAEEF,MAFFE,QACAC,MACEH,MADFG,MAGInQ,IAAM,SAACsC,SAAS,UAACyL,6BAASzL,EAAO8N,SAAa,IAAJrC,EAAS,IAAM,MAE/DwB,QAAOD,QAAU,SAACQ,GAChBC,KAAKD,EAAOG,QAASjQ,IAAI,YACzB+P,KAAKD,EAAOI,QAASlQ,IAAI,YACzB+P,KAAKD,EAAOK,MAAOnQ,IAAI;ICVvB,OAAO,GAGL,KAAK,CAHP,OAAO;AHJT,GAAIoD,CGKF,KHLStG,EGKF,GAEL,GHPe,EGOV,CAFP,IHJFyS,GGIS,KHJFD,QAAUlM,KAAK9B,IAAI,iBAAkB,2EAA4E,SAASwB,GAAQhG,QAAQ,UAAUwG;IGKzJ,CRYK,IQZA,GACH,KRWM,AQXD,CADP,KAAK;ARYK,AOlBZ,IAAM,GPkBS,CAAC,AOlBN,GAAG,CPkBO,AMlBpB,CNkBqB,CAAC,EMlBlBuM,ECAgB,CAAC,GDAV/S,QAAQ,OCAoB,CAAC,CAAC,iBDEzCyS,QAAOD,QAAU,SAAUQ,GACzBA,EAAMD,KAAOA;AEMf,ADRA,GPiByB,CAAA,AOjBnB,ECQA,CAAC,EDRI,GAAG,ECQA,GAAG,EDRI,CAAC,OCQJ,KAAK,EAAK,YDRoB,CAAC,CAAC;ADDlD,AHAA,CHmBC,CAAC,CAAA,AGnBEzM,CGAA,IAAI,CHAGtG,EGAA,MHAQ,CGAD,CAAC,KHCnByS,QAAOD,QAAUlM,IGD2B,CAAC,AHCvB9B,CGDwB,GHCpB,OAAQ,gNAAiN,SAASwB,GAAQhG,QAAQ,UAAUwG;AKUpR,IDPA,GCOK,CAAC,GDPC,GAGL,CCIW,GAAG,CDJT,CAHP,OAAO,GCOe;ARUxB,AQTI,AFVJ,ICGE,EDHI,CAAC,CEUC,CRSC,AQTA,EDPA,CPgBG,CAAC,AQTA,CAAC,ADLV,ADLU,GAAG,ENmBE,AOdV,CAFP,CPgBmB,AQTA,CAAC,CAAA,IDPb,ADHkB,KAAK,EAAE;ANoB9B,AMnBF,GEUC,CAAA,ADPD,EPgBM,CACD,AMpBA,CAAC,CCGD,GACH,ADJQ,CNoBC,CAAC,CMpBC,ECIN,CADP,CDHiB,CAAC,GCGb,CPiBO,CAAC;CMnBd,CAAA,SNmBkB,CAAC,KAAK,MAAM;AQR7B,ADNF,GPc+B,CAAC,AOd1B,CPeC,EQTA,ADNE,CCMD,EDNI,EPeE,CAAC,EQTA,GAAG,EDNL,GPeE,CAAC,AOfC,MCMO;AACpB,QAAI,CAAC,ADPa,EPeF,CAAC,CAAC,AQRT,CAAC,KDPS,CAAC,CCOH,CRQU,AQRT,CRQU,AQRV,GRQa,CAAC,QAAQ,CAAC;GAAA,AQP1C,CRO2C,AQP3C,CRO2C,0BOfd,IAAI,EAAG,QAAQ,CAAC,CAAC,GAAG,GAAG,EAAE,EAAE,CAAC,GAAG,GAAG;GAAE;APiBhE,AQPF,CDVkE,CAAC,KCU9D,CROG,AQPF,CROG,IQPE,GAAG,EROI,CAAC,MAAM,CAAC,EQPN,MROc,CAAC,CAAC;AQNlC,CROH,OQPO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;ADTpB,GCUG,CAAA,EDVG,CAAC,OAAO,GAAG,UAAC,KAAK,EAAK;AAC1B,CCUD,CAAA,IDVK,CAAC,KAAK,EAAE,OAAO,EAAE,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;AACrC,MAAI,CAAC,KAAK,EAAE,OAAO,EAAE,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;AACrC,MAAI,CAAC,KAAK,EAAE,KAAK,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC;CAClC,CAAA","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports={\"EXCITED\":0,\"NEUTRAL\":1,\"BORED\":2}","module.exports=[{\"href\":\"#mood\",\"name\":\"Mood\"},{\"href\":\"#results\",\"name\":\"Results\"}]","module.exports={\"READ\":114,\"END\":101}","require('./views/menu')\n\nrequire('./views/excitement-in')\nrequire('./views/excitement-out')\n\nrequire('riot').mount('*')\n\nconst router = require('./logic/router');\nconst tabs = [\n  document.querySelector('results'),\n  document.querySelector('mood')\n]\n\nconst [results, mood] = tabs;\n\n\nrouter({\n  results() { tab(results); },\n  mood () { tab(mood);  }\n})\n\nfunction tab(target) {\n    tabs\n      .filter(t => t !== target)\n      .forEach(t => t.classList.add('hidden'))\n\n    target.classList.remove('hidden');\n}","/* Riot v2.2.1, @license MIT, (c) 2015 Muut Inc. + contributors */\n\n;(function(window) {\n  'use strict'\n  var riot = { version: 'v2.2.1', settings: {} }\n\n  // This globals 'const' helps code size reduction\n\n  // for typeof == '' comparisons\n  var T_STRING = 'string'\n  var T_OBJECT = 'object'\n\n  // for IE8 and rest of the world\n  var isArray = Array.isArray || (function () {\n    var _ts = Object.prototype.toString\n    return function (v) { return _ts.call(v) === '[object Array]' }\n  })()\n\n  // Version# for IE 8-11, 0 for others\n  var ieVersion = (function (win) {\n    return (win && win.document || {}).documentMode | 0\n  })(window)\n\nriot.observable = function(el) {\n\n  el = el || {}\n\n  var callbacks = {},\n      _id = 0\n\n  el.on = function(events, fn) {\n    if (isFunction(fn)) {\n      fn._id = typeof fn._id == 'undefined' ? _id++ : fn._id\n\n      events.replace(/\\S+/g, function(name, pos) {\n        (callbacks[name] = callbacks[name] || []).push(fn)\n        fn.typed = pos > 0\n      })\n    }\n    return el\n  }\n\n  el.off = function(events, fn) {\n    if (events == '*') callbacks = {}\n    else {\n      events.replace(/\\S+/g, function(name) {\n        if (fn) {\n          var arr = callbacks[name]\n          for (var i = 0, cb; (cb = arr && arr[i]); ++i) {\n            if (cb._id == fn._id) { arr.splice(i, 1); i-- }\n          }\n        } else {\n          callbacks[name] = []\n        }\n      })\n    }\n    return el\n  }\n\n  // only single event supported\n  el.one = function(name, fn) {\n    function on() {\n      el.off(name, on)\n      fn.apply(el, arguments)\n    }\n    return el.on(name, on)\n  }\n\n  el.trigger = function(name) {\n    var args = [].slice.call(arguments, 1),\n        fns = callbacks[name] || []\n\n    for (var i = 0, fn; (fn = fns[i]); ++i) {\n      if (!fn.busy) {\n        fn.busy = 1\n        fn.apply(el, fn.typed ? [name].concat(args) : args)\n        if (fns[i] !== fn) { i-- }\n        fn.busy = 0\n      }\n    }\n\n    if (callbacks.all && name != 'all') {\n      el.trigger.apply(el, ['all', name].concat(args))\n    }\n\n    return el\n  }\n\n  return el\n\n}\nriot.mixin = (function() {\n  var mixins = {}\n\n  return function(name, mixin) {\n    if (!mixin) return mixins[name]\n    mixins[name] = mixin\n  }\n\n})()\n\n;(function(riot, evt, window) {\n\n  // browsers only\n  if (!window) return\n\n  var loc = window.location,\n      fns = riot.observable(),\n      win = window,\n      started = false,\n      current\n\n  function hash() {\n    return loc.href.split('#')[1] || ''\n  }\n\n  function parser(path) {\n    return path.split('/')\n  }\n\n  function emit(path) {\n    if (path.type) path = hash()\n\n    if (path != current) {\n      fns.trigger.apply(null, ['H'].concat(parser(path)))\n      current = path\n    }\n  }\n\n  var r = riot.route = function(arg) {\n    // string\n    if (arg[0]) {\n      loc.hash = arg\n      emit(arg)\n\n    // function\n    } else {\n      fns.on('H', arg)\n    }\n  }\n\n  r.exec = function(fn) {\n    fn.apply(null, parser(hash()))\n  }\n\n  r.parser = function(fn) {\n    parser = fn\n  }\n\n  r.stop = function () {\n    if (!started) return\n    win.removeEventListener ? win.removeEventListener(evt, emit, false) : win.detachEvent('on' + evt, emit)\n    fns.off('*')\n    started = false\n  }\n\n  r.start = function () {\n    if (started) return\n    win.addEventListener ? win.addEventListener(evt, emit, false) : win.attachEvent('on' + evt, emit)\n    started = true\n  }\n\n  // autostart the router\n  r.start()\n\n})(riot, 'hashchange', window)\n/*\n\n//// How it works?\n\n\nThree ways:\n\n1. Expressions: tmpl('{ value }', data).\n   Returns the result of evaluated expression as a raw object.\n\n2. Templates: tmpl('Hi { name } { surname }', data).\n   Returns a string with evaluated expressions.\n\n3. Filters: tmpl('{ show: !done, highlight: active }', data).\n   Returns a space separated list of trueish keys (mainly\n   used for setting html classes), e.g. \"show highlight\".\n\n\n// Template examples\n\ntmpl('{ title || \"Untitled\" }', data)\ntmpl('Results are { results ? \"ready\" : \"loading\" }', data)\ntmpl('Today is { new Date() }', data)\ntmpl('{ message.length > 140 && \"Message is too long\" }', data)\ntmpl('This item got { Math.round(rating) } stars', data)\ntmpl('<h1>{ title }</h1>{ body }', data)\n\n\n// Falsy expressions in templates\n\nIn templates (as opposed to single expressions) all falsy values\nexcept zero (undefined/null/false) will default to empty string:\n\ntmpl('{ undefined } - { false } - { null } - { 0 }', {})\n// will return: \" - - - 0\"\n\n*/\n\n\nvar brackets = (function(orig) {\n\n  var cachedBrackets,\n      r,\n      b,\n      re = /[{}]/g\n\n  return function(x) {\n\n    // make sure we use the current setting\n    var s = riot.settings.brackets || orig\n\n    // recreate cached vars if needed\n    if (cachedBrackets !== s) {\n      cachedBrackets = s\n      b = s.split(' ')\n      r = b.map(function (e) { return e.replace(/(?=.)/g, '\\\\') })\n    }\n\n    // if regexp given, rewrite it with current brackets (only if differ from default)\n    return x instanceof RegExp ? (\n        s === orig ? x :\n        new RegExp(x.source.replace(re, function(b) { return r[~~(b === '}')] }), x.global ? 'g' : '')\n      ) :\n      // else, get specific bracket\n      b[x]\n  }\n})('{ }')\n\n\nvar tmpl = (function() {\n\n  var cache = {},\n      reVars = /(['\"\\/]).*?[^\\\\]\\1|\\.\\w*|\\w*:|\\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\\b|function *\\()|([a-z_$]\\w*)/gi\n              // [ 1               ][ 2  ][ 3 ][ 4                                                                                  ][ 5       ]\n              // find variable names:\n              // 1. skip quoted strings and regexps: \"a b\", 'a b', 'a \\'b\\'', /a b/\n              // 2. skip object properties: .name\n              // 3. skip object literals: name:\n              // 4. skip javascript keywords\n              // 5. match var name\n\n  // build a template (or get it from cache), render with data\n  return function(str, data) {\n    return str && (cache[str] = cache[str] || tmpl(str))(data)\n  }\n\n\n  // create a template instance\n\n  function tmpl(s, p) {\n\n    // default template string to {}\n    s = (s || (brackets(0) + brackets(1)))\n\n      // temporarily convert \\{ and \\} to a non-character\n      .replace(brackets(/\\\\{/g), '\\uFFF0')\n      .replace(brackets(/\\\\}/g), '\\uFFF1')\n\n    // split string to expression and non-expresion parts\n    p = split(s, extract(s, brackets(/{/), brackets(/}/)))\n\n    return new Function('d', 'return ' + (\n\n      // is it a single expression or a template? i.e. {x} or <b>{x}</b>\n      !p[0] && !p[2] && !p[3]\n\n        // if expression, evaluate it\n        ? expr(p[1])\n\n        // if template, evaluate all expressions in it\n        : '[' + p.map(function(s, i) {\n\n            // is it an expression or a string (every second part is an expression)\n          return i % 2\n\n              // evaluate the expressions\n              ? expr(s, true)\n\n              // process string parts of the template:\n              : '\"' + s\n\n                  // preserve new lines\n                  .replace(/\\n/g, '\\\\n')\n\n                  // escape quotes\n                  .replace(/\"/g, '\\\\\"')\n\n                + '\"'\n\n        }).join(',') + '].join(\"\")'\n      )\n\n      // bring escaped { and } back\n      .replace(/\\uFFF0/g, brackets(0))\n      .replace(/\\uFFF1/g, brackets(1))\n\n    + ';')\n\n  }\n\n\n  // parse { ... } expression\n\n  function expr(s, n) {\n    s = s\n\n      // convert new lines to spaces\n      .replace(/\\n/g, ' ')\n\n      // trim whitespace, brackets, strip comments\n      .replace(brackets(/^[{ ]+|[ }]+$|\\/\\*.+?\\*\\//g), '')\n\n    // is it an object literal? i.e. { key : value }\n    return /^\\s*[\\w- \"']+ *:/.test(s)\n\n      // if object literal, return trueish keys\n      // e.g.: { show: isOpen(), done: item.done } -> \"show done\"\n      ? '[' +\n\n          // extract key:val pairs, ignoring any nested objects\n          extract(s,\n\n              // name part: name:, \"name\":, 'name':, name :\n              /[\"' ]*[\\w- ]+[\"' ]*:/,\n\n              // expression part: everything upto a comma followed by a name (see above) or end of line\n              /,(?=[\"' ]*[\\w- ]+[\"' ]*:)|}|$/\n              ).map(function(pair) {\n\n                // get key, val parts\n                return pair.replace(/^[ \"']*(.+?)[ \"']*: *(.+?),? *$/, function(_, k, v) {\n\n                  // wrap all conditional parts to ignore errors\n                  return v.replace(/[^&|=!><]+/g, wrap) + '?\"' + k + '\":\"\",'\n\n                })\n\n              }).join('')\n\n        + '].join(\" \").trim()'\n\n      // if js expression, evaluate as javascript\n      : wrap(s, n)\n\n  }\n\n\n  // execute js w/o breaking on errors or undefined vars\n\n  function wrap(s, nonull) {\n    s = s.trim()\n    return !s ? '' : '(function(v){try{v='\n\n        // prefix vars (name => data.name)\n        + (s.replace(reVars, function(s, _, v) { return v ? '(d.'+v+'===undefined?'+(typeof window == 'undefined' ? 'global.' : 'window.')+v+':d.'+v+')' : s })\n\n          // break the expression if its empty (resulting in undefined value)\n          || 'x')\n      + '}catch(e){'\n      + '}finally{return '\n\n        // default to empty string for falsy values except zero\n        + (nonull === true ? '!v&&v!==0?\"\":v' : 'v')\n\n      + '}}).call(d)'\n  }\n\n\n  // split string by an array of substrings\n\n  function split(str, substrings) {\n    var parts = []\n    substrings.map(function(sub, i) {\n\n      // push matched expression and part before it\n      i = str.indexOf(sub)\n      parts.push(str.slice(0, i), sub)\n      str = str.slice(i + sub.length)\n    })\n\n    // push the remaining part\n    return parts.concat(str)\n  }\n\n\n  // match strings between opening and closing regexp, skipping any inner/nested matches\n\n  function extract(str, open, close) {\n\n    var start,\n        level = 0,\n        matches = [],\n        re = new RegExp('('+open.source+')|('+close.source+')', 'g')\n\n    str.replace(re, function(_, open, close, pos) {\n\n      // if outer inner bracket, mark position\n      if (!level && open) start = pos\n\n      // in(de)crease bracket level\n      level += open ? 1 : -1\n\n      // if outer closing bracket, grab the match\n      if (!level && close != null) matches.push(str.slice(start, pos+close.length))\n\n    })\n\n    return matches\n  }\n\n})()\n\n// { key, i in items} -> { key, i, items }\nfunction loopKeys(expr) {\n  var b0 = brackets(0),\n      els = expr.slice(b0.length).match(/\\s*(\\S+?)\\s*(?:,\\s*(\\S)+)?\\s+in\\s+(.+)/)\n  return els ? { key: els[1], pos: els[2], val: b0 + els[3] } : { val: expr }\n}\n\nfunction mkitem(expr, key, val) {\n  var item = {}\n  item[expr.key] = key\n  if (expr.pos) item[expr.pos] = val\n  return item\n}\n\n\n/* Beware: heavy stuff */\nfunction _each(dom, parent, expr) {\n\n  remAttr(dom, 'each')\n\n  var template = dom.outerHTML,\n      root = dom.parentNode,\n      placeholder = document.createComment('riot placeholder'),\n      tags = [],\n      child = getTag(dom),\n      checksum\n\n  root.insertBefore(placeholder, dom)\n\n  expr = loopKeys(expr)\n\n  // clean template code\n  parent\n    .one('premount', function () {\n      if (root.stub) root = parent.root\n      // remove the original DOM node\n      dom.parentNode.removeChild(dom)\n    })\n    .on('update', function () {\n      var items = tmpl(expr.val, parent),\n          test\n\n      // object loop. any changes cause full redraw\n      if (!isArray(items)) {\n        test = checksum\n        checksum = items ? JSON.stringify(items) : ''\n        if (checksum === test) return\n\n        items = !items ? [] :\n          Object.keys(items).map(function (key) {\n            return mkitem(expr, key, items[key])\n          })\n      }\n\n      var frag = document.createDocumentFragment(),\n          i = tags.length,\n          j = items.length\n\n      // unmount leftover items\n      while (i > j) tags[--i].unmount()\n      tags.length = j\n\n      test = !checksum && !!expr.key\n      for (i = 0; i < j; ++i) {\n        var _item = test ? mkitem(expr, items[i], i) : items[i]\n\n        if (!tags[i]) {\n          // mount new\n          (tags[i] = new Tag({ tmpl: template }, {\n              parent: parent,\n              isLoop: true,\n              root: root,\n              item: _item\n            })\n          ).mount()\n\n          frag.appendChild(tags[i].root)\n        }\n        tags[i]._item = _item\n        tags[i].update(_item)\n      }\n\n      root.insertBefore(frag, placeholder)\n\n      if (child) parent.tags[getTagName(dom)] = tags\n\n    }).one('updated', function() {\n      var keys = Object.keys(parent)// only set new values\n      walk(root, function(node) {\n        // only set element node and not isLoop\n        if (node.nodeType == 1 && !node.isLoop && !node._looped) {\n          node._visited = false // reset _visited for loop node\n          node._looped = true // avoid set multiple each\n          setNamed(node, parent, keys)\n        }\n      })\n    })\n\n}\n\n\nfunction parseNamedElements(root, parent, childTags) {\n\n  walk(root, function(dom) {\n    if (dom.nodeType == 1) {\n      dom.isLoop = (dom.parentNode && dom.parentNode.isLoop || dom.getAttribute('each')) ? 1 : 0\n\n      // custom child tag\n      var child = getTag(dom)\n\n      if (child && !dom.isLoop) {\n        var tag = new Tag(child, { root: dom, parent: parent }, dom.innerHTML),\n            tagName = getTagName(dom),\n            ptag = parent,\n            cachedTag\n\n        while (!getTag(ptag.root)) {\n          if (!ptag.parent) break\n          ptag = ptag.parent\n        }\n\n        // fix for the parent attribute in the looped elements\n        tag.parent = ptag\n\n        cachedTag = ptag.tags[tagName]\n\n        // if there are multiple children tags having the same name\n        if (cachedTag) {\n          // if the parent tags property is not yet an array\n          // create it adding the first cached tag\n          if (!isArray(cachedTag))\n            ptag.tags[tagName] = [cachedTag]\n          // add the new nested tag to the array\n          ptag.tags[tagName].push(tag)\n        } else {\n          ptag.tags[tagName] = tag\n        }\n\n        // empty the child node once we got its template\n        // to avoid that its children get compiled multiple times\n        dom.innerHTML = ''\n        childTags.push(tag)\n      }\n\n      if (!dom.isLoop)\n        setNamed(dom, parent, [])\n    }\n\n  })\n\n}\n\nfunction parseExpressions(root, tag, expressions) {\n\n  function addExpr(dom, val, extra) {\n    if (val.indexOf(brackets(0)) >= 0) {\n      var expr = { dom: dom, expr: val }\n      expressions.push(extend(expr, extra))\n    }\n  }\n\n  walk(root, function(dom) {\n    var type = dom.nodeType\n\n    // text node\n    if (type == 3 && dom.parentNode.tagName != 'STYLE') addExpr(dom, dom.nodeValue)\n    if (type != 1) return\n\n    /* element */\n\n    // loop\n    var attr = dom.getAttribute('each')\n\n    if (attr) { _each(dom, tag, attr); return false }\n\n    // attribute expressions\n    each(dom.attributes, function(attr) {\n      var name = attr.name,\n        bool = name.split('__')[1]\n\n      addExpr(dom, attr.value, { attr: bool || name, bool: bool })\n      if (bool) { remAttr(dom, name); return false }\n\n    })\n\n    // skip custom tags\n    if (getTag(dom)) return false\n\n  })\n\n}\nfunction Tag(impl, conf, innerHTML) {\n\n  var self = riot.observable(this),\n      opts = inherit(conf.opts) || {},\n      dom = mkdom(impl.tmpl),\n      parent = conf.parent,\n      isLoop = conf.isLoop,\n      item = conf.item,\n      expressions = [],\n      childTags = [],\n      root = conf.root,\n      fn = impl.fn,\n      tagName = root.tagName.toLowerCase(),\n      attr = {},\n      loopDom,\n      TAG_ATTRIBUTES = /([\\w\\-]+)\\s?=\\s?['\"]([^'\"]+)[\"']/gim\n\n\n  if (fn && root._tag) {\n    root._tag.unmount(true)\n  }\n\n  // not yet mounted\n  this.isMounted = false\n\n  if (impl.attrs) {\n    var attrs = impl.attrs.match(TAG_ATTRIBUTES)\n\n    each(attrs, function(a) {\n      var kv = a.split(/\\s?=\\s?/)\n      root.setAttribute(kv[0], kv[1].replace(/['\"]/g, ''))\n    })\n\n  }\n\n  // keep a reference to the tag just created\n  // so we will be able to mount this tag multiple times\n  root._tag = this\n\n  // create a unique id to this tag\n  // it could be handy to use it also to improve the virtual dom rendering speed\n  this._id = fastAbs(~~(new Date().getTime() * Math.random()))\n\n  extend(this, { parent: parent, root: root, opts: opts, tags: {} }, item)\n\n  // grab attributes\n  each(root.attributes, function(el) {\n    var val = el.value\n    // remember attributes with expressions only\n    if (brackets(/\\{.*\\}/).test(val)) attr[el.name] = val\n  })\n\n  if (dom.innerHTML && !/select|select|optgroup|tbody|tr/.test(tagName))\n    // replace all the yield tags with the tag inner html\n    dom.innerHTML = replaceYield(dom.innerHTML, innerHTML)\n\n  // options\n  function updateOpts() {\n    // update opts from current DOM attributes\n    each(root.attributes, function(el) {\n      opts[el.name] = tmpl(el.value, parent || self)\n    })\n    // recover those with expressions\n    each(Object.keys(attr), function(name) {\n      opts[name] = tmpl(attr[name], parent || self)\n    })\n  }\n\n  this.update = function(data) {\n    extend(self, data)\n    updateOpts()\n    self.trigger('update', data)\n    update(expressions, self, data)\n    self.trigger('updated')\n  }\n\n  this.mixin = function() {\n    each(arguments, function(mix) {\n      mix = typeof mix == 'string' ? riot.mixin(mix) : mix\n      each(Object.keys(mix), function(key) {\n        // bind methods to self\n        if (key != 'init')\n          self[key] = typeof mix[key] == 'function' ? mix[key].bind(self) : mix[key]\n      })\n      // init method will be called automatically\n      if (mix.init) mix.init.bind(self)()\n    })\n  }\n\n  this.mount = function() {\n\n    updateOpts()\n\n    // initialiation\n    fn && fn.call(self, opts)\n\n    toggle(true)\n\n\n    // parse layout after init. fn may calculate args for nested custom tags\n    parseExpressions(dom, self, expressions)\n\n    if (!self.parent) self.update()\n\n    // internal use only, fixes #403\n    self.trigger('premount')\n\n    if (isLoop) {\n      // update the root attribute for the looped elements\n      self.root = root = loopDom = dom.firstChild\n    } else {\n      while (dom.firstChild) root.appendChild(dom.firstChild)\n      if (root.stub) self.root = root = parent.root\n    }\n    // if it's not a child tag we can trigger its mount event\n    if (!self.parent || self.parent.isMounted) {\n      self.isMounted = true\n      self.trigger('mount')\n    }\n    // otherwise we need to wait that the parent event gets triggered\n    else self.parent.one('mount', function() {\n      // avoid to trigger the `mount` event for the tags\n      // not visible included in an if statement\n      if (!isInStub(self.root)) {\n        self.parent.isMounted = self.isMounted = true\n        self.trigger('mount')\n      }\n    })\n  }\n\n\n  this.unmount = function(keepRootTag) {\n    var el = loopDom || root,\n        p = el.parentNode\n\n    if (p) {\n\n      if (parent) {\n        // remove this tag from the parent tags object\n        // if there are multiple nested tags with same name..\n        // remove this element form the array\n        if (isArray(parent.tags[tagName])) {\n          each(parent.tags[tagName], function(tag, i) {\n            if (tag._id == self._id)\n              parent.tags[tagName].splice(i, 1)\n          })\n        } else\n          // otherwise just delete the tag instance\n          parent.tags[tagName] = undefined\n      } else {\n        while (el.firstChild) el.removeChild(el.firstChild)\n      }\n\n      if (!keepRootTag)\n        p.removeChild(el)\n\n    }\n\n\n    self.trigger('unmount')\n    toggle()\n    self.off('*')\n    // somehow ie8 does not like `delete root._tag`\n    root._tag = null\n\n  }\n\n  function toggle(isMount) {\n\n    // mount/unmount children\n    each(childTags, function(child) { child[isMount ? 'mount' : 'unmount']() })\n\n    // listen/unlisten parent (events flow one way from parent to children)\n    if (parent) {\n      var evt = isMount ? 'on' : 'off'\n\n      // the loop tags will be always in sync with the parent automatically\n      if (isLoop)\n        parent[evt]('unmount', self.unmount)\n      else\n        parent[evt]('update', self.update)[evt]('unmount', self.unmount)\n    }\n  }\n\n  // named elements available for fn\n  parseNamedElements(dom, this, childTags)\n\n\n}\n\nfunction setEventHandler(name, handler, dom, tag, item) {\n\n  dom[name] = function(e) {\n\n    // cross browser event fix\n    e = e || window.event\n\n    if (!e.which) e.which = e.charCode || e.keyCode\n    if (!e.target) e.target = e.srcElement\n\n    // ignore error on some browsers\n    try {\n      e.currentTarget = dom\n    } catch (ignored) { '' }\n\n    e.item = tag._item ? tag._item : item\n\n    // prevent default behaviour (by default)\n    if (handler.call(tag, e) !== true && !/radio|check/.test(dom.type)) {\n      e.preventDefault && e.preventDefault()\n      e.returnValue = false\n    }\n\n    if (!e.preventUpdate) {\n      var el = item ? tag.parent : tag\n      el.update()\n    }\n\n  }\n\n}\n\n// used by if- attribute\nfunction insertTo(root, node, before) {\n  if (root) {\n    root.insertBefore(before, node)\n    root.removeChild(node)\n  }\n}\n\n// item = currently looped item\nfunction update(expressions, tag, item) {\n\n  each(expressions, function(expr, i) {\n\n    var dom = expr.dom,\n        attrName = expr.attr,\n        value = tmpl(expr.expr, tag),\n        parent = expr.dom.parentNode\n\n    if (value == null) value = ''\n\n    // leave out riot- prefixes from strings inside textarea\n    if (parent && parent.tagName == 'TEXTAREA') value = value.replace(/riot-/g, '')\n\n    // no change\n    if (expr.value === value) return\n    expr.value = value\n\n    // text node\n    if (!attrName) return dom.nodeValue = value.toString()\n\n    // remove original attribute\n    remAttr(dom, attrName)\n\n    // event handler\n    if (typeof value == 'function') {\n      setEventHandler(attrName, value, dom, tag, item)\n\n    // if- conditional\n    } else if (attrName == 'if') {\n      var stub = expr.stub\n\n      // add to DOM\n      if (value) {\n        if (stub) {\n          insertTo(stub.parentNode, stub, dom)\n          dom.inStub = false\n          // avoid to trigger the mount event if the tags is not visible yet\n          // maybe we can optimize this avoiding to mount the tag at all\n          if (!isInStub(dom)) {\n            walk(dom, function(el) {\n              if (el._tag && !el._tag.isMounted) el._tag.isMounted = !!el._tag.trigger('mount')\n            })\n          }\n        }\n      // remove from DOM\n      } else {\n        stub = expr.stub = stub || document.createTextNode('')\n        insertTo(dom.parentNode, dom, stub)\n        dom.inStub = true\n      }\n    // show / hide\n    } else if (/^(show|hide)$/.test(attrName)) {\n      if (attrName == 'hide') value = !value\n      dom.style.display = value ? '' : 'none'\n\n    // field value\n    } else if (attrName == 'value') {\n      dom.value = value\n\n    // <img src=\"{ expr }\">\n    } else if (attrName.slice(0, 5) == 'riot-' && attrName != 'riot-tag') {\n      attrName = attrName.slice(5)\n      value ? dom.setAttribute(attrName, value) : remAttr(dom, attrName)\n\n    } else {\n      if (expr.bool) {\n        dom[attrName] = value\n        if (!value) return\n        value = attrName\n      }\n\n      if (typeof value != 'object') dom.setAttribute(attrName, value)\n\n    }\n\n  })\n\n}\n\nfunction each(els, fn) {\n  for (var i = 0, len = (els || []).length, el; i < len; i++) {\n    el = els[i]\n    // return false -> remove current item during loop\n    if (el != null && fn(el, i) === false) i--\n  }\n  return els\n}\n\nfunction isFunction(v) {\n  return typeof v === 'function' || false   // avoid IE problems\n}\n\nfunction remAttr(dom, name) {\n  dom.removeAttribute(name)\n}\n\nfunction fastAbs(nr) {\n  return (nr ^ (nr >> 31)) - (nr >> 31)\n}\n\nfunction getTagName(dom) {\n  var child = getTag(dom),\n    namedTag = dom.getAttribute('name'),\n    tagName = namedTag && namedTag.indexOf(brackets(0)) < 0 ? namedTag : child.name\n\n  return tagName\n}\n\nfunction extend(src) {\n  var obj, args = arguments\n  for (var i = 1; i < args.length; ++i) {\n    if ((obj = args[i])) {\n      for (var key in obj) {      // eslint-disable-line guard-for-in\n        src[key] = obj[key]\n      }\n    }\n  }\n  return src\n}\n\nfunction mkdom(template) {\n  var checkie = ieVersion && ieVersion < 10,\n      matches = /^\\s*<([\\w-]+)/.exec(template),\n      tagName = matches ? matches[1].toLowerCase() : '',\n      rootTag = (tagName === 'th' || tagName === 'td') ? 'tr' :\n                (tagName === 'tr' ? 'tbody' : 'div'),\n      el = mkEl(rootTag)\n\n  el.stub = true\n\n  if (checkie) {\n    if (tagName === 'optgroup')\n      optgroupInnerHTML(el, template)\n    else if (tagName === 'option')\n      optionInnerHTML(el, template)\n    else if (rootTag !== 'div')\n      tbodyInnerHTML(el, template, tagName)\n    else\n      checkie = 0\n  }\n  if (!checkie) el.innerHTML = template\n\n  return el\n}\n\nfunction walk(dom, fn) {\n  if (dom) {\n    if (fn(dom) === false) walk(dom.nextSibling, fn)\n    else {\n      dom = dom.firstChild\n\n      while (dom) {\n        walk(dom, fn)\n        dom = dom.nextSibling\n      }\n    }\n  }\n}\n\nfunction isInStub(dom) {\n  while (dom) {\n    if (dom.inStub) return true\n    dom = dom.parentNode\n  }\n  return false\n}\n\nfunction mkEl(name) {\n  return document.createElement(name)\n}\n\nfunction replaceYield (tmpl, innerHTML) {\n  return tmpl.replace(/<(yield)\\/?>(<\\/\\1>)?/gim, innerHTML || '')\n}\n\nfunction $$(selector, ctx) {\n  return (ctx || document).querySelectorAll(selector)\n}\n\nfunction inherit(parent) {\n  function Child() {}\n  Child.prototype = parent\n  return new Child()\n}\n\nfunction setNamed(dom, parent, keys) {\n  each(dom.attributes, function(attr) {\n    if (dom._visited) return\n    if (attr.name === 'id' || attr.name === 'name') {\n      dom._visited = true\n      var p, v = attr.value\n      if (~keys.indexOf(v)) return\n\n      p = parent[v]\n      if (!p)\n        parent[v] = dom\n      else\n        isArray(p) ? p.push(dom) : (parent[v] = [p, dom])\n    }\n  })\n}\n/**\n *\n * Hacks needed for the old internet explorer versions [lower than IE10]\n *\n */\n\nfunction tbodyInnerHTML(el, html, tagName) {\n  var div = mkEl('div'),\n      loops = /td|th/.test(tagName) ? 3 : 2,\n      child\n\n  div.innerHTML = '<table>' + html + '</table>'\n  child = div.firstChild\n\n  while (loops--) {\n    child = child.firstChild\n  }\n\n  el.appendChild(child)\n\n}\n\nfunction optionInnerHTML(el, html) {\n  var opt = mkEl('option'),\n      valRegx = /value=[\\\"'](.+?)[\\\"']/,\n      selRegx = /selected=[\\\"'](.+?)[\\\"']/,\n      eachRegx = /each=[\\\"'](.+?)[\\\"']/,\n      ifRegx = /if=[\\\"'](.+?)[\\\"']/,\n      innerRegx = />([^<]*)</,\n      valuesMatch = html.match(valRegx),\n      selectedMatch = html.match(selRegx),\n      innerValue = html.match(innerRegx),\n      eachMatch = html.match(eachRegx),\n      ifMatch = html.match(ifRegx)\n\n  if (innerValue) {\n    opt.innerHTML = innerValue[1]\n  } else {\n    opt.innerHTML = html\n  }\n\n  if (valuesMatch) {\n    opt.value = valuesMatch[1]\n  }\n\n  if (selectedMatch) {\n    opt.setAttribute('riot-selected', selectedMatch[1])\n  }\n\n  if (eachMatch) {\n    opt.setAttribute('each', eachMatch[1])\n  }\n\n  if (ifMatch) {\n    opt.setAttribute('if', ifMatch[1])\n  }\n\n  el.appendChild(opt)\n}\n\nfunction optgroupInnerHTML(el, html) {\n  var opt = mkEl('optgroup'),\n      labelRegx = /label=[\\\"'](.+?)[\\\"']/,\n      elementRegx = /^<([^>]*)>/,\n      tagRegx = /^<([^ \\>]*)/,\n      labelMatch = html.match(labelRegx),\n      elementMatch = html.match(elementRegx),\n      tagMatch = html.match(tagRegx),\n      innerContent = html\n\n  if (elementMatch) {\n    var options = html.slice(elementMatch[1].length+2, -tagMatch[1].length-3).trim()\n    innerContent = options\n  }\n\n  if (labelMatch) {\n    opt.setAttribute('riot-label', labelMatch[1])\n  }\n\n  if (innerContent) {\n    var innerOpt = mkEl('div')\n\n    optionInnerHTML(innerOpt, innerContent)\n\n    opt.appendChild(innerOpt.firstChild)\n  }\n\n  el.appendChild(opt)\n}\n\n/*\n Virtual dom is an array of custom tags on the document.\n Updates and unmounts propagate downwards from parent to children.\n*/\n\nvar virtualDom = [],\n    tagImpl = {},\n    styleNode\n\nvar RIOT_TAG = 'riot-tag'\n\nfunction getTag(dom) {\n  return tagImpl[dom.getAttribute(RIOT_TAG) || dom.tagName.toLowerCase()]\n}\n\nfunction injectStyle(css) {\n\n  styleNode = styleNode || mkEl('style')\n\n  if (!document.head) return\n\n  if (styleNode.styleSheet)\n    styleNode.styleSheet.cssText += css\n  else\n    styleNode.innerHTML += css\n\n  if (!styleNode._rendered)\n    if (styleNode.styleSheet) {\n      document.body.appendChild(styleNode)\n    } else {\n      var rs = $$('style[type=riot]')[0]\n      if (rs) {\n        rs.parentNode.insertBefore(styleNode, rs)\n        rs.parentNode.removeChild(rs)\n      } else {\n        document.head.appendChild(styleNode)\n      }\n    }\n\n  styleNode._rendered = true\n\n}\n\nfunction mountTo(root, tagName, opts) {\n  var tag = tagImpl[tagName],\n      // cache the inner HTML to fix #855\n      innerHTML = root._innerHTML = root._innerHTML || root.innerHTML\n\n  // clear the inner html\n  root.innerHTML = ''\n\n  if (tag && root) tag = new Tag(tag, { root: root, opts: opts }, innerHTML)\n\n  if (tag && tag.mount) {\n    tag.mount()\n    virtualDom.push(tag)\n    return tag.on('unmount', function() {\n      virtualDom.splice(virtualDom.indexOf(tag), 1)\n    })\n  }\n\n}\n\nriot.tag = function(name, html, css, attrs, fn) {\n  if (isFunction(attrs)) {\n    fn = attrs\n    if (/^[\\w\\-]+\\s?=/.test(css)) {\n      attrs = css\n      css = ''\n    } else attrs = ''\n  }\n  if (css) {\n    if (isFunction(css)) fn = css\n    else injectStyle(css)\n  }\n  tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\nriot.mount = function(selector, tagName, opts) {\n\n  var els,\n      allTags,\n      tags = []\n\n  // helper functions\n\n  function addRiotTags(arr) {\n    var list = ''\n    each(arr, function (e) {\n      list += ', *[riot-tag=\"'+ e.trim() + '\"]'\n    })\n    return list\n  }\n\n  function selectAllTags() {\n    var keys = Object.keys(tagImpl)\n    return keys + addRiotTags(keys)\n  }\n\n  function pushTags(root) {\n    if (root.tagName) {\n      if (tagName && !root.getAttribute(RIOT_TAG))\n        root.setAttribute(RIOT_TAG, tagName)\n\n      var tag = mountTo(root,\n        tagName || root.getAttribute(RIOT_TAG) || root.tagName.toLowerCase(), opts)\n\n      if (tag) tags.push(tag)\n    }\n    else if (root.length) {\n      each(root, pushTags)   // assume nodeList\n    }\n  }\n\n  // ----- mount code -----\n\n  if (typeof tagName === T_OBJECT) {\n    opts = tagName\n    tagName = 0\n  }\n\n  // crawl the DOM to find the tag\n  if (typeof selector === T_STRING) {\n    if (selector === '*') {\n      // select all the tags registered\n      // and also the tags found with the riot-tag attribute set\n      selector = allTags = selectAllTags()\n    } else {\n      // or just the ones named like the selector\n      selector += addRiotTags(selector.split(','))\n    }\n    els = $$(selector)\n  }\n  else\n    // probably you have passed already a tag or a NodeList\n    els = selector\n\n  // select all the registered and mount them inside their root elements\n  if (tagName === '*') {\n    // get all custom tags\n    tagName = allTags || selectAllTags()\n    // if the root els it's just a single tag\n    if (els.tagName) {\n      els = $$(tagName, els)\n    } else {\n      // select all the children for all the different root elements\n      var nodeList = []\n      each(els, function (_el) {\n        nodeList.push($$(tagName, _el))\n      })\n      els = nodeList\n    }\n    // get rid of the tagName\n    tagName = 0\n  }\n\n  if (els.tagName)\n    pushTags(els)\n  else\n    each(els, pushTags)\n\n  return tags\n}\n\n// update everything\nriot.update = function() {\n  return each(virtualDom, function(tag) {\n    tag.update()\n  })\n}\n\n// @deprecated\nriot.mountTo = riot.mount\n\n\n  // share methods for other riot parts, e.g. compiler\n  riot.util = { brackets: brackets, tmpl: tmpl }\n\n  // support CommonJS, AMD & browser\n  if (typeof exports === 'object')\n    module.exports = riot\n  else if (typeof define === 'function' && define.amd)\n    define(function() { return riot })\n  else\n    window.riot = riot\n\n})(typeof window != 'undefined' ? window : undefined);\n","const riot = require('riot');\n\nmodule.exports = (routes = {}) => {\n\n  riot.route(function (...path) {\n    path = path.filter(s => s.length);\n    path = path[0];\n\n    if (routes[path] instanceof Function) {\n     routes[path]();\n   }\n  })\n\n}","var riot = require('riot');\nmodule.exports = riot.tag('menu', '<div class=\"pure-menu pure-menu-horizontal\"> <ul class=\"pure-menu-list\"> <li class=\"pure-menu-item\" each=\"{item, i in menu}\"> <a href=\"{item.href}\" class=\"pure-menu-link\">{item.name}</a> </li> </ul> </div>', function(opts) { require('./view')(this) \n});","var riot = require('riot');\nmodule.exports = riot.tag('excitement-in', '<p>How excited are you?</p> <div> <input onclick=\"{ excited }\" id=\"excited\" type=\"radio\" name=\"excitement\" value=\"excited\"> <label for=\"excited\" class=\"pure-radio\"></label> </div> <div> <input onclick=\"{ neutral }\" id=\"neutral\" type=\"radio\" name=\"excitement\" value=\"neutral\"> <label for=\"neutral\" class=\"pure-radio\"></label> </div> <div> <input onclick=\"{ bored }\" id=\"bored\" type=\"radio\" name=\"excitement\" value=\"bored\"> <label for=\"bored\" class=\"pure-radio\"></label> </div>', 'excitement-in label, [riot-tag=\"excitement-in\"] label{font-size: 8em;opacity:0.75;} excitement-in input[type=radio], [riot-tag=\"excitement-in\"] input[type=radio]{display:none;} excitement-in input[type=radio]:checked + label, [riot-tag=\"excitement-in\"] input[type=radio]:checked + label{opacity:1;}', function(opts) { require('./view')(this)\n});\n\n\n","var riot = require('riot');\nmodule.exports = riot.tag('excitement-out', '<p> : { excited } </p> <p> : { neutral } </p> <p> : { bored } </p>', function(opts) { require('./view')(this)\n});\n","var menu = require('@atmos/config/menu.json');\n\nmodule.exports = function (scope) {\n  scope.menu = menu;\n}","const sync = require('../../logic/sync');\nconst enums = require('@atmos/config/enums.json');\n\nconst {\n  EXCITED,\n  NEUTRAL,\n  BORED\n} = enums;\n\nconst map = (name) => (n) => ({[name]: parseInt(n * 100, 10) + '%'});\n\nmodule.exports = (scope) => {\n  sync(scope, EXCITED, map('excited'));\n  sync(scope, NEUTRAL, map('neutral'));\n  sync(scope, BORED, map('bored'));\n}","const sync = require('../../logic/sync');\nconst enums = require('@atmos/config/enums.json');\n\nconst {\n  EXCITED,\n  NEUTRAL,\n  BORED\n} = enums;\n\nmodule.exports = (scope) => {\n\n  scope.excited = () => {\n    sync.vote(EXCITED)\n  }\n\n  scope.neutral = () => {\n    sync.vote(NEUTRAL)\n  }\n\n  scope.bored = () => {\n    sync.vote(BORED)\n  }\n}","var pull = require('websocket-pull-stream');\nvar ws = new WebSocket('ws://localhost:4001');\nvar srv = pull(ws)();\nvar uid = require('./uid')().split('').map((c) => c.charCodeAt(0));\n\nmodule.exports = (scope, chan, map) => {\n  if (typeof chan !== 'number') { \n    throw Error('must supply channel');\n  }\n\n  const sink = pull.Funnel(function (obj) {\n    Object.assign(scope, obj);\n    scope.update();\n  });\n\n  if (map instanceof Function) {\n    return srv\n      .demux.channel(chan)\n      .pipe(pull.Tunnel(map)())\n      .pipe(sink());\n  }\n\n  return srv\n    .demux.channel(chan)\n    .pipe(sink());\n}\n\nmodule.exports.vote = (chan) => {\n  if (typeof chan !== 'number') { \n    throw Error('must supply channel');\n  }\n\n  ws.send(new Uint8Array(uid.concat(chan)));\n}\n\nmodule.exports.srv = srv;\nmodule.exports.pull = pull;\n","module.exports = () => {\n  localStorage.uid = localStorage.uid || Math.random().toString(35).substr(2, 7);\n  return localStorage.uid;\n}","require('setimmediate-min')();\nvar pull = require('pull-core')\nvar plex = require('pull-plex')\nvar utils = require('./lib/utils');\nvar cmd = require('./cmds.json')\nvar cmdKeys = Object.keys(cmd) \nvar cmds = cmdKeys.map(function(c) {\n  return cmd[c]; \n})\nvar encCmds = cmdKeys.reduce(function (o, k) {\n  o[k] = [0, cmd[k]];\n  return o;\n}, {})\nvar noop = utils.noop;\nvar wrap = utils.wrap;\nvar encase = utils.encase;\nvar facade = utils.facade;\nvar defaults = utils.defaults;\n\nmodule.exports = webSocketPullStream\nmodule.exports.__proto__ = require('pull-core');\n\nfunction webSocketPullStream (socket, opts) {\n  facade(socket);\n\n  opts = defaults(opts || {})\n\n  var multi = plex()\n  var flow = opts.mode === 'flow';\n  var View = opts.View;\n  var command = makeCommandHandler(View)\n  var source = pull.Source(function () {\n    return function src(end, cb) {\n      if (src.ran) { return; } \n      src.ran = true;\n      function next (msg) { cb(0, msg) }\n      socket.on('message', next)\n    }\n  })()\n  var bridge = pull.Sink(function (read) {\n    function next(end, data) {\n      if (end) {\n        end = command.pull.indexOf(next.r)\n        if (~~end) command.pull.splice(end, 1)\n        return\n      };\n      if (socket.readyState > 1)\n        return read(Error('Socket closed'), next)\n      \n      socket.send(data)\n\n      if (flow) return setImmediate(read, 0, next)\n      next.r = function () { read(end, next) }  \n    }\n    \n    read(null, function (end, data) { \n      next(end, data) \n      command.pull.push(next.r)\n    })\n    \n  })\n  var waitReady = pull.Through(function (read) {\n    return function src(end, cb) {\n      if (socket.readyState !== 1)\n        return socket.on('open', function () { \n          src(end, cb)\n        })\n      \n      read(null, function (end, data) {\n        read(end, cb)\n      })\n    }\n  })\n  var cmdReciever = Funnel(function (msg) {\n      return command(msg)\n  })()\n  var readRequester = Tunnel(function () {\n    if (!flow) socket.send(new View(encCmds.READ))\n  })()\n  var wrapper = Tunnel(function (data) {\n    return wrap(data, View);\n  })()\n  var json = {\n    stringify: Tunnel(function (data) {\n      return data && \n        (data.constructor === Object || Array.isArray(data)) ?\n          JSON.stringify(data) :\n          data;\n    })(),\n    parse: Tunnel(function (data, cb) {\n      try {\n        cb(null, JSON.parse(data))\n      } catch (e) {\n        cb(e)         \n      }\n    })()\n  }\n\n  var coaxial = multi(source)\n  var duplex;\n\n  coaxial.channel(0).pipe(cmdReciever)\n  coaxial.demux()\n\n  multi(noop /* command stream */)\n  multi(bridge())\n  multi(bridge())\n\n  duplex = waitReady()\n    .pipe(Tunnel(function (data) {\n      return typeof data === 'number' ? data+'' : data;\n    })())\n    .pipe(multi.channel(1))\n\n  duplex.objects = json\n    .stringify\n    .pipe(encase(waitReady()\n      .pipe(multi.channel(2))\n    )())\n\n  duplex.source = coaxial\n    .channel(1)\n    .pipe(wrapper)\n    .pipe(readRequester)\n\n  duplex.objects.source = coaxial\n    .channel(2)\n    .pipe(json.parse)\n    .pipe(readRequester)\n\n  duplex.sink = duplex.data = duplex.objects.data = duplex;\n\n  duplex.objects.sink = duplex.objects;\n\n  duplex.pipe = function (stream) {\n    return duplex.source.pipe(stream)\n  }\n\n  duplex.objects.pipe = function (stream) {\n    return duplex.objects.source.pipe(stream)\n  }\n\n  duplex.demux = coaxial;\n  duplex.mux = multi;\n\n  multi.offset(3); //set multiplexer offset\n                  //thus making channels 0-2 \"private\"\n\n  //overwrite multiplexer channel methods\n  //so that mux/demux channels work seamlessly\n  //over the transport\n  multi.channel = (function (channel) {\n    return function muxChannel(n) {\n      if (!multi.channels[n+3]) multi(bridge())\n      return channel(n)\n    }\n  }(multi.channel))\n\n  coaxial.channel = (function (channel) {\n    return function demuxChannel(n) {\n      var chan = channel(n)\n      var stream = chan.pipe(readRequester);\n      stream.__proto__ = chan;\n      return stream;\n    }\n  }(coaxial.channel)) \n\n  return encase(duplex);\n}\n\nwebSocketPullStream.Tunnel = Tunnel;\nwebSocketPullStream.Funnel = Funnel;\n\nfunction Tunnel (fn) {\n  return encase(pull.Through(function (read) {\n    return function (end, cb) {\n      read(null, function (end, data) {\n        var mutation;\n        if (fn.length < 2) {\n          mutation = fn(data)\n          cb(end, typeof mutation !== 'undefined' ? mutation : data)\n          return;\n        }\n        fn(data, function (end, mutation) {\n          cb(end, typeof mutation !== 'undefined' ? mutation : data)\n        })\n      })\n    }\n  })())\n}\n\nfunction Funnel(fn) {\n  return pull.Sink(function (read) {\n    read(null, function (end, data) {\n      if (end || fn(data)) socket.close()      \n    })\n  })\n}\n\nfunction makeCommandHandler(View) {\n  function cmd(message, read) {\n    message = (new View(message))[0];\n    if (!~cmds.indexOf(message)) return;\n    if (message === cmd.END) return cmd.END;\n    cmd.pull.forEach(function (fn) {fn()});\n  }\n\n  cmd.pull = [];\n\n  return cmd;\n}\n\n","function noop(){}\nfunction wrap(data, View) {\n  return typeof data === 'string' ? \n    data : \n    new View(data);\n}\nfunction encase(duplex) {\n  return function stream(mode) { \n    return mode === Object ? duplex.objects : duplex;\n  }\n}\nfunction facade(socket) {\n  socket.binaryType = 'arraybuffer';\n  socket.on = socket.on || function (topic, fn) {\n    function cb(e) {\n      fn(e.data || e)\n    }\n    fn.cb = cb;\n    socket.addEventListener(topic, cb)\n  }\n  socket.removeListener = socket.removeListener || function (topic, fn) {\n    socket.removeEventListener(topic, fn.cb || fn)\n  } \n}\nfunction defaults(opts) { \n  opts.View = opts.View || window.Uint8Array || String;\n  return opts;\n}\nmodule.exports = {\n  noop: noop,\n  wrap: wrap,\n  encase: encase,\n  facade: facade,\n  defaults: defaults\n}","var pull = require('pull-core')\nvar encdec = require('./lib/encdec')\nvar devnull = pull.Sink(function(read) {\n  read(0, function next(end, d) {\n    // console.log('pp', d) \n    if (end) {return}\n    read(end, next) \n  })\n})\n\nvar recieverChannel = pull.Source(function () {\n  var aborted, cbs = [];\n  function channel (end, cb) {\n    if (end) { return; }\n    if (~cbs.indexOf(cb)) { return; }\n    cbs.push(cb);\n  }\n  channel.abort = function () { aborted = true; }\n  channel.next = function (data) {\n    cbs.forEach(function (cb) {\n      cb(aborted, data)\n    });\n  }\n  return channel;\n})\n\nvar mux = pull.Through(function (read, stream, index) {\n  var aborted;\n  function through(end, cb) {\n    if (end) {return;}\n    read(0, function (end, data) {\n      if (end) {return;}\n      cb(aborted || end, encdec(data, index))\n    })\n  }\n  through.abort = function () { aborted = true; }\n  return through\n})\n\nvar demux = pull.Through(function (read, stream, channels, offset) {\n  function coax(end, cb) {\n    if (end) {return;}\n    read(0, function (end, data) {\n      if (end) {return;}\n      var decoded = encdec(data)\n      var chan = decoded.chan\n      chan -= offset.by;\n      channels[chan] = coax.channel(chan) \n      channels[chan].next(decoded.data)\n      cb(end, data)\n    })\n  }\n\n  coax.channels = channels;\n  coax.channel =  function (chan) {\n    chan += offset.by;\n    return channels[chan] || \n      (channels[chan] = recieverChannel())\n  }\n\n  return coax;\n})\n\nfunction remover(channel, channels) {\n  return function () {\n      var ix = channel.index;\n      channel.abort();\n      channels.slice(ix).forEach(function (s) {\n        s.index -= 1;\n      })\n      channels.splice(ix, 1);\n    }\n}\n\nmodule.exports = function plex() {\n  var channels = [], demuxxing = [];\n\n  function multi(stream) {\n    var ix, channel;\n\n    if (stream.type === 'Source') {\n      stream = stream.pipe(demux(stream, demuxxing, offset));\n      stream.demux = function demux() { \n        return (demux.ed = demux.ed || stream.pipe(devnull())); \n      }\n      return stream;\n    }\n    ix = channels.length\n    channel = mux(stream, ix).pipe(stream)\n    channel.remove = remover(channel, channels)\n\n    channels.push(channel)\n\n    return channel;\n  }\n\n  multi.channels = channels;\n\n  multi.channel = function (chan) { \n    return channels[chan + offset.by];\n  }\n\n  multi.offset = offset\n\n  offset.by = 0\n  function offset(n) {\n    offset.by = n;\n  }\n\n\n  return multi;\n\n}","var global = (function(){return this}());\nmodule.exports = function () {\n  global.setImmediate = global.setImmediate || function () {\n    var args = [].slice.apply(arguments);\n    args.splice(1, 0, 0)\n    setTimeout.apply(null, args)\n  }\n}","exports.id = \nfunction (item) {\n  return item\n}\n\nexports.prop = \nfunction (map) {  \n  if('string' == typeof map) {\n    var key = map\n    return function (data) { return data[key] }\n  }\n  return map\n}\n\nexports.tester = function (test) {\n  if(!test) return exports.id\n  if('object' === typeof test\n    && 'function' === typeof test.test)\n      return test.test.bind(test)\n  return exports.prop(test) || exports.id\n}\n\nexports.addPipe = addPipe\n\nfunction addPipe(read) {\n  if('function' !== typeof read)\n    return read\n\n  read.pipe = read.pipe || function (reader) {\n    if('function' != typeof reader && 'function' != typeof reader.sink)\n      throw new Error('must pipe to reader')\n    var pipe = addPipe(reader.sink ? reader.sink(read) : reader(read))\n    return reader.source || pipe;\n  }\n  \n  read.type = 'Source'\n  return read\n}\n\nvar Source =\nexports.Source =\nfunction Source (createRead) {\n  function s() {\n    var args = [].slice.call(arguments)\n    return addPipe(createRead.apply(null, args))\n  }\n  s.type = 'Source'\n  return s\n}\n\n\nvar Through =\nexports.Through = \nfunction (createRead) {\n  return function () {\n    var args = [].slice.call(arguments)\n    var piped = []\n    function reader (read) {\n      args.unshift(read)\n      read = createRead.apply(null, args)\n      while(piped.length)\n        read = piped.shift()(read)\n      return read\n      //pipeing to from this reader should compose...\n    }\n    reader.pipe = function (read) {\n      piped.push(read) \n      if(read.type === 'Source')\n        throw new Error('cannot pipe ' + reader.type + ' to Source')\n      reader.type = read.type === 'Sink' ? 'Sink' : 'Through'\n      return reader\n    }\n    reader.type = 'Through'\n    return reader\n  }\n}\n\nvar Sink =\nexports.Sink = \nfunction Sink(createReader) {\n  return function () {\n    var args = [].slice.call(arguments)\n    if(!createReader)\n      throw new Error('must be createReader function')\n    function s (read) {\n      args.unshift(read)\n      return createReader.apply(null, args)\n    }\n    s.type = 'Sink'\n    return s\n  }\n}\n\n\nexports.maybeSink = \nexports.maybeDrain = \nfunction (createSink, cb) {\n  if(!cb)\n    return Through(function (read) {\n      var ended\n      return function (close, cb) {\n        if(close) return read(close, cb)\n        if(ended) return cb(ended)\n\n        createSink(function (err, data) {\n          ended = err || true\n          if(!err) cb(null, data)\n          else     cb(ended)\n        }) (read)\n      }\n    })()\n\n  return Sink(function (read) {\n    return createSink(cb) (read)\n  })()\n}\n\n","var string = require('./encdec-string')\nvar varint = require('varint')\n\nmodule.exports = function(data, chan) {\n  var chunk, viSize;\n  if (typeof data === 'string') {\n    return string.apply(0, arguments);\n  }\n\n  data = new Uint8Array(data.buffer || data);\n\n  if (arguments.length > 1) {\n      viSize = varint.encodingLength(chan);\n      chunk = new Uint8Array(new ArrayBuffer(data.byteLength + viSize))\n      varint.encode(chan, chunk)\n      chunk.set(data, viSize)\n      return chunk.buffer\n  }\n    \n  return {\n    chan: varint.decode(data),\n    data: data.buffer.slice(varint.decode.bytes)\n  }\n\n}","var varint = require('varint');\nvar FILL = String.fromCharCode(128);\n\nmodule.exports = function (data, chan) {\n  \n  if (arguments.length > 1)\n    return varint.encode(chan).map(function (n) {\n      return String.fromCharCode(n);\n    }).join('') + data;\n\n  var maxVarintLength = 0;\n  while (++maxVarintLength && (data[maxVarintLength] === FILL));\n  maxVarintLength += 8;\n\n  return {\n    chan: varint.decode(data\n      .slice(0, maxVarintLength)\n      .split('')\n      .map(function (s) { return s.charCodeAt(0) })),\n    data: data.slice(varint.decode.bytes)\n  }\n}","module.exports = {\n    encode: require('./encode.js')\n  , decode: require('./decode.js')\n  , encodingLength: require('./length.js')\n}\n","module.exports = encode\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31)\n\nfunction encode(num, out, offset) {\n  out = out || []\n  offset = offset || 0\n  var oldOffset = offset\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB\n    num /= 128\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB\n    num >>>= 7\n  }\n  out[offset] = num | 0\n  \n  encode.bytes = offset - oldOffset + 1\n  \n  return out\n}\n","\nvar N1 = Math.pow(2,  7)\nvar N2 = Math.pow(2, 14)\nvar N3 = Math.pow(2, 21)\nvar N4 = Math.pow(2, 28)\nvar N5 = Math.pow(2, 35)\nvar N6 = Math.pow(2, 42)\nvar N7 = Math.pow(2, 49)\n\nmodule.exports = function (value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  :              8\n  )\n}\n","module.exports = read\n\nvar MSB = 0x80\n  , REST = 0x7F\n\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length\n  \n  do {\n    if(counter >= l) {\n      read.bytesRead = 0\n      return undefined\n    }\n    b = buf[counter++]\n    res += shift < 28\n      ? (b & REST) << shift\n      : (b & REST) * Math.pow(2, shift)\n    shift += 7\n  } while (b >= MSB)\n  \n  read.bytes = counter - offset\n  \n  return res\n}\n"]}